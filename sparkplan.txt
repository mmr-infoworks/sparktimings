QUERY GENERATED BY TABLEAU
================================
EXPLAIN SELECT STORE_FLATTENED.CLX_IRI_MARKET_AREA AS CLX_IRI_MARKET_AREA
,STORE_FLATTENED.IDR_DFLT_WHSE AS IDR_DFLT_WHSE
,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK AS SALES_AMT_LAST_WK
,ITEM_FLATTEN.SUPPLIER AS SUPPLIER
FROM 8N_POS_INV_DASHBOARD_CUBE.POS_INV_FACT_ROLLUP POS_INV_FACT_ROLLUP LEFT OUTER JOIN
8N_POS_INV_DASHBOARD_CUBE.STORE_FLATTENED STORE_FLATTENED
ON (POS_INV_FACT_ROLLUP.WMSTRNBR = STORE_FLATTENED.WM_STR_NBR__STORE_CLEANED)
JOIN 8N_POS_INV_DASHBOARD_CUBE.ITEM_FLATTEN ITEM_FLATTEN
ON (POS_INV_FACT_ROLLUP.WM_ITEM_NBR = ITEM_FLATTEN.WM_ITEM_NBR)
LEFT JOIN 8N_POS_INV_DASHBOARD_CUBE.WM_M_CAL_WEEK_2 WM_M_CAL_WEEK_2
--NOTE THE FILTER IS ON DIMENSION TABLE BELOW
ON (POS_INV_FACT_ROLLUP.WM_WK = WM_M_CAL_WEEK_2.WM_WK) WHERE WM_M_CAL_WEEK_2.WM_WK = 201634
 GROUP BY STORE_FLATTENED.CLX_IRI_MARKET_AREA
,STORE_FLATTENED.IDR_DFLT_WHSE
,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK
,ITEM_FLATTEN.SUPPLIER ;



-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
| == Physical Plan ==
*HashAggregate(keys=[CLX_IRI_MARKET_AREA#49259, IDR_DFLT_WHSE#49245, SALES_AMT_LAST_WK#49175, SUPPLIER#49369], functions=[])
+- Exchange hashpartitioning(CLX_IRI_MARKET_AREA#49259, IDR_DFLT_WHSE#49245, SALES_AMT_LAST_WK#49175, SUPPLIER#49369, 200)
   +- *HashAggregate(keys=[CLX_IRI_MARKET_AREA#49259, IDR_DFLT_WHSE#49245, SALES_AMT_LAST_WK#49175, SUPPLIER#49369], functions=[])
      +- *Project [sales_amt_last_wk#49175, idr_dflt_whse#49245, clx_iri_market_area#49259, supplier#49369]
         +- *BroadcastHashJoin [WM_WK#49121], [WM_WK#49429], Inner, BuildRight
            :- *Project [sales_amt_last_wk#49175, wm_wk#49121, idr_dflt_whse#49245, clx_iri_market_area#49259, supplier#49369]
            :  +- *BroadcastHashJoin [WM_ITEM_NBR#49123], [WM_ITEM_NBR#49274], Inner, BuildRight
            :     :- *Project [wm_item_nbr#49123, sales_amt_last_wk#49175, wm_wk#49121, idr_dflt_whse#49245, clx_iri_market_area#49259]
            :     :  +- *BroadcastHashJoin [WMSTRNBR#49122], [WM_STR_NBR__STORE_CLEANED#49199], LeftOuter, BuildRight
            :     :     :- *Filter ((isnotnull(WM_ITEM_NBR#49123) && isnotnull(WM_WK#49121)) && (WM_WK#49121 = 201634))
            :     :     :  +- InMemoryTableScan [wmstrnbr#49122, wm_item_nbr#49123, sales_amt_last_wk#49175, wm_wk#49121], [isnotnull(WM_ITEM_NBR#49123), isnotnull(WM_WK#49121), (WM_WK#49121 = 201634)]
            :     :     :     :  +- InMemoryRelation [wmstrnbr#49122, wm_item_nbr#49123, on_hand_qty#49124, on_hand_retail_amt#49125, on_order_qty#49126, in_transit_qty#49127, in_transit_retail_amt#49128, in_whse_qty#49129, in_whse_retail_amt#49130, whse_ss_order_qty#49131, wos#49132, sales_amt#49133, sales_qty#49134, cost_amt#49135, avg_amt#49136, si_mumd_qty#49137, si_mumd_amt#49138, si_mumd_percent#49139, gross_ship_qty#49140, gross_ship_cost_amt#49141, gross_ship_avg_amt#49142, traited_str_count#49143, valid_str_count#49144, pos_str_count#49145, ... 51 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`
            :     :     :     :     :  +- HiveTableScan [wmstrnbr#43605, wm_item_nbr#43606, on_hand_qty#43607, on_hand_retail_amt#43608, on_order_qty#43609, in_transit_qty#43610, in_transit_retail_amt#43611, in_whse_qty#43612, in_whse_retail_amt#43613, whse_ss_order_qty#43614, wos#43615, sales_amt#43616, sales_qty#43617, cost_amt#43618, avg_amt#43619, si_mumd_qty#43620, si_mumd_amt#43621, si_mumd_percent#43622, gross_ship_qty#43623, gross_ship_cost_amt#43624, gross_ship_avg_amt#43625, traited_str_count#43626, valid_str_count#43627, pos_str_count#43628, ... 51 more fields], MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup
            :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
            :     :        +- HiveTableScan [wm_str_nbr__store_cleaned#49199, idr_dflt_whse#49245, clx_iri_market_area#49259], MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
            :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, false]))
            :        +- *Filter isnotnull(WM_ITEM_NBR#49274)
            :           +- HiveTableScan [wm_item_nbr#49274, supplier#49369], MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
            +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)))
               +- *Filter (isnotnull(WM_WK#49429) && (WM_WK#49429 = 201634))
                  +- HiveTableScan [wm_wk#49429], MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2  |



QUERY OPTIMIZED BY CHANGING FILTER
EXPLAIN SELECT STORE_FLATTENED.CLX_IRI_MARKET_AREA AS CLX_IRI_MARKET_AREA
 ,STORE_FLATTENED.IDR_DFLT_WHSE AS IDR_DFLT_WHSE
 ,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK AS SALES_AMT_LAST_WK
 ,ITEM_FLATTEN.SUPPLIER AS SUPPLIER
 FROM 8N_POS_INV_DASHBOARD_CUBE.POS_INV_FACT_ROLLUP POS_INV_FACT_ROLLUP LEFT OUTER JOIN
 8N_POS_INV_DASHBOARD_CUBE.STORE_FLATTENED STORE_FLATTENED
 ON (POS_INV_FACT_ROLLUP.WMSTRNBR = STORE_FLATTENED.WM_STR_NBR__STORE_CLEANED)
 JOIN 8N_POS_INV_DASHBOARD_CUBE.ITEM_FLATTEN ITEM_FLATTEN
 ON (POS_INV_FACT_ROLLUP.WM_ITEM_NBR = ITEM_FLATTEN.WM_ITEM_NBR)
 LEFT JOIN 8N_POS_INV_DASHBOARD_CUBE.WM_M_CAL_WEEK_2 WM_M_CAL_WEEK_2
 --NOTE THE FILTER IS ON DIMENSION TABLE BELOW
 ON (POS_INV_FACT_ROLLUP.WM_WK = WM_M_CAL_WEEK_2.WM_WK) WHERE POS_INV_FACT_ROLLUP.WM_WK = 201634
  GROUP BY STORE_FLATTENED.CLX_IRI_MARKET_AREA
 ,STORE_FLATTENED.IDR_DFLT_WHSE
 ,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK
 ,ITEM_FLATTEN.SUPPLIER ;
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
| == Physical Plan ==
*HashAggregate(keys=[CLX_IRI_MARKET_AREA#49996, IDR_DFLT_WHSE#49982, SALES_AMT_LAST_WK#49912, SUPPLIER#50106], functions=[])
+- Exchange hashpartitioning(CLX_IRI_MARKET_AREA#49996, IDR_DFLT_WHSE#49982, SALES_AMT_LAST_WK#49912, SUPPLIER#50106, 200)
   +- *HashAggregate(keys=[CLX_IRI_MARKET_AREA#49996, IDR_DFLT_WHSE#49982, SALES_AMT_LAST_WK#49912, SUPPLIER#50106], functions=[])
      +- *Project [sales_amt_last_wk#49912, idr_dflt_whse#49982, clx_iri_market_area#49996, supplier#50106]
         +- *BroadcastHashJoin [WM_WK#49858], [WM_WK#50166], LeftOuter, BuildRight
            :- *Project [sales_amt_last_wk#49912, wm_wk#49858, idr_dflt_whse#49982, clx_iri_market_area#49996, supplier#50106]
            :  +- *BroadcastHashJoin [WM_ITEM_NBR#49860], [WM_ITEM_NBR#50011], Inner, BuildRight
            :     :- *Project [wm_item_nbr#49860, sales_amt_last_wk#49912, wm_wk#49858, idr_dflt_whse#49982, clx_iri_market_area#49996]
            :     :  +- *BroadcastHashJoin [WMSTRNBR#49859], [WM_STR_NBR__STORE_CLEANED#49936], LeftOuter, BuildRight
            :     :     :- *Filter ((isnotnull(WM_WK#49858) && (WM_WK#49858 = 201634)) && isnotnull(WM_ITEM_NBR#49860))
            :     :     :  +- InMemoryTableScan [wmstrnbr#49859, wm_item_nbr#49860, sales_amt_last_wk#49912, wm_wk#49858], [isnotnull(WM_WK#49858), (WM_WK#49858 = 201634), isnotnull(WM_ITEM_NBR#49860)]
            :     :     :     :  +- InMemoryRelation [wmstrnbr#49859, wm_item_nbr#49860, on_hand_qty#49861, on_hand_retail_amt#49862, on_order_qty#49863, in_transit_qty#49864, in_transit_retail_amt#49865, in_whse_qty#49866, in_whse_retail_amt#49867, whse_ss_order_qty#49868, wos#49869, sales_amt#49870, sales_qty#49871, cost_amt#49872, avg_amt#49873, si_mumd_qty#49874, si_mumd_amt#49875, si_mumd_percent#49876, gross_ship_qty#49877, gross_ship_cost_amt#49878, gross_ship_avg_amt#49879, traited_str_count#49880, valid_str_count#49881, pos_str_count#49882, ... 51 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`
            :     :     :     :     :  +- HiveTableScan [wmstrnbr#43605, wm_item_nbr#43606, on_hand_qty#43607, on_hand_retail_amt#43608, on_order_qty#43609, in_transit_qty#43610, in_transit_retail_amt#43611, in_whse_qty#43612, in_whse_retail_amt#43613, whse_ss_order_qty#43614, wos#43615, sales_amt#43616, sales_qty#43617, cost_amt#43618, avg_amt#43619, si_mumd_qty#43620, si_mumd_amt#43621, si_mumd_percent#43622, gross_ship_qty#43623, gross_ship_cost_amt#43624, gross_ship_avg_amt#43625, traited_str_count#43626, valid_str_count#43627, pos_str_count#43628, ... 51 more fields], MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup
            :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
            :     :        +- HiveTableScan [wm_str_nbr__store_cleaned#49936, idr_dflt_whse#49982, clx_iri_market_area#49996], MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
            :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, false]))
            :        +- *Filter isnotnull(WM_ITEM_NBR#50011)
            :           +- HiveTableScan [wm_item_nbr#50011, supplier#50106], MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
            +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               +- HiveTableScan [wm_wk#50166], MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2  |



ANOTHER QUERY WITHOUT PARTITION FILTER
======================================


0: jdbc:hive2://localhost:10016> EXPLAIN SELECT STORE_FLATTENED.CLX_IRI_MARKET_AREA AS CLX_IRI_MARKET_AREA
0: jdbc:hive2://localhost:10016> ,STORE_FLATTENED.IDR_DFLT_WHSE AS IDR_DFLT_WHSE
0: jdbc:hive2://localhost:10016> ,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK AS SALES_AMT_LAST_WK
0: jdbc:hive2://localhost:10016> ,ITEM_FLATTEN.SUPPLIER AS SUPPLIER
0: jdbc:hive2://localhost:10016> FROM 8N_POS_INV_DASHBOARD_CUBE.POS_INV_FACT_ROLLUP POS_INV_FACT_ROLLUP
0: jdbc:hive2://localhost:10016> LEFT OUTER JOIN 8N_POS_INV_DASHBOARD_CUBE.STORE_FLATTENED STORE_FLATTENED
0: jdbc:hive2://localhost:10016> ON (POS_INV_FACT_ROLLUP.WMSTRNBR = STORE_FLATTENED.WM_STR_NBR__STORE_CLEANED)
0: jdbc:hive2://localhost:10016>  JOIN 8N_POS_INV_DASHBOARD_CUBE.ITEM_FLATTEN ITEM_FLATTEN
0: jdbc:hive2://localhost:10016>   ON (POS_INV_FACT_ROLLUP.WM_ITEM_NBR = ITEM_FLATTEN.WM_ITEM_NBR)
0: jdbc:hive2://localhost:10016>   LEFT JOIN 8N_POS_INV_DASHBOARD_CUBE.WM_M_CAL_WEEK_2 WM_M_CAL_WEEK_2
0: jdbc:hive2://localhost:10016>   ON (POS_INV_FACT_ROLLUP.WM_WK = WM_M_CAL_WEEK_2.WM_WK)
0: jdbc:hive2://localhost:10016>   WHERE POS_INV_FACT_ROLLUP.cost_amt_lyr_last_wk > 1000
0: jdbc:hive2://localhost:10016>   GROUP BY STORE_FLATTENED.CLX_IRI_MARKET_AREA
0: jdbc:hive2://localhost:10016> ,STORE_FLATTENED.IDR_DFLT_WHSE
0: jdbc:hive2://localhost:10016> ,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK
0: jdbc:hive2://localhost:10016> ,ITEM_FLATTEN.SUPPLIER LIMIT 100;
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
| == Physical Plan ==
CollectLimit 100
+- *HashAggregate(keys=[CLX_IRI_MARKET_AREA#53271, IDR_DFLT_WHSE#53257, SALES_AMT_LAST_WK#53187, SUPPLIER#53381], functions=[])
   +- Exchange hashpartitioning(CLX_IRI_MARKET_AREA#53271, IDR_DFLT_WHSE#53257, SALES_AMT_LAST_WK#53187, SUPPLIER#53381, 200)
      +- *HashAggregate(keys=[CLX_IRI_MARKET_AREA#53271, IDR_DFLT_WHSE#53257, SALES_AMT_LAST_WK#53187, SUPPLIER#53381], functions=[])
         +- *Project [sales_amt_last_wk#53187, idr_dflt_whse#53257, clx_iri_market_area#53271, supplier#53381]
            +- *BroadcastHashJoin [WM_WK#53133], [WM_WK#53441], LeftOuter, BuildRight
               :- *Project [sales_amt_last_wk#53187, wm_wk#53133, idr_dflt_whse#53257, clx_iri_market_area#53271, supplier#53381]
               :  +- *BroadcastHashJoin [WM_ITEM_NBR#53135], [WM_ITEM_NBR#53286], Inner, BuildRight
               :     :- *Project [wm_item_nbr#53135, sales_amt_last_wk#53187, wm_wk#53133, idr_dflt_whse#53257, clx_iri_market_area#53271]
               :     :  +- *BroadcastHashJoin [WMSTRNBR#53134], [WM_STR_NBR__STORE_CLEANED#53211], LeftOuter, BuildRight
               :     :     :- *Project [wmstrnbr#53134, wm_item_nbr#53135, sales_amt_last_wk#53187, wm_wk#53133]
               :     :     :  +- *Filter ((isnotnull(cost_amt_lyr_last_wk#53197) && (cost_amt_lyr_last_wk#53197 > 1000.0)) && isnotnull(WM_ITEM_NBR#53135))
               :     :     :     +- InMemoryTableScan [wmstrnbr#53134, wm_wk#53133, wm_item_nbr#53135, cost_amt_lyr_last_wk#53197, sales_amt_last_wk#53187], [isnotnull(cost_amt_lyr_last_wk#53197), (cost_amt_lyr_last_wk#53197 > 1000.0), isnotnull(WM_ITEM_NBR#53135)]
               :     :     :        :  +- InMemoryRelation [wmstrnbr#53134, wm_item_nbr#53135, on_hand_qty#53136, on_hand_retail_amt#53137, on_order_qty#53138, in_transit_qty#53139, in_transit_retail_amt#53140, in_whse_qty#53141, in_whse_retail_amt#53142, whse_ss_order_qty#53143, wos#53144, sales_amt#53145, sales_qty#53146, cost_amt#53147, avg_amt#53148, si_mumd_qty#53149, si_mumd_amt#53150, si_mumd_percent#53151, gross_ship_qty#53152, gross_ship_cost_amt#53153, gross_ship_avg_amt#53154, traited_str_count#53155, valid_str_count#53156, pos_str_count#53157, ... 51 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`
               :     :     :        :     :  +- HiveTableScan [wmstrnbr#43605, wm_item_nbr#43606, on_hand_qty#43607, on_hand_retail_amt#43608, on_order_qty#43609, in_transit_qty#43610, in_transit_retail_amt#43611, in_whse_qty#43612, in_whse_retail_amt#43613, whse_ss_order_qty#43614, wos#43615, sales_amt#43616, sales_qty#43617, cost_amt#43618, avg_amt#43619, si_mumd_qty#43620, si_mumd_amt#43621, si_mumd_percent#43622, gross_ship_qty#43623, gross_ship_cost_amt#43624, gross_ship_avg_amt#43625, traited_str_count#43626, valid_str_count#43627, pos_str_count#43628, ... 51 more fields], MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup
               :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :     :        +- HiveTableScan [wm_str_nbr__store_cleaned#53211, idr_dflt_whse#53257, clx_iri_market_area#53271], MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
               :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, false]))
               :        +- *Filter isnotnull(WM_ITEM_NBR#53286)
               :           +- HiveTableScan [wm_item_nbr#53286, supplier#53381], MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  +- HiveTableScan [wm_wk#53441], MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2  |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
: jdbc:hive2://localhost:10016> EXPLAIN SELECT STORE_FLATTENED.CLX_IRI_MARKET_AREA AS CLX_IRI_MARKET_AREA
0: jdbc:hive2://localhost:10016> ,STORE_FLATTENED.IDR_DFLT_WHSE AS IDR_DFLT_WHSE
0: jdbc:hive2://localhost:10016> ,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK AS SALES_AMT_LAST_WK
0: jdbc:hive2://localhost:10016> ,ITEM_FLATTEN.SUPPLIER AS SUPPLIER
0: jdbc:hive2://localhost:10016> FROM 8N_POS_INV_DASHBOARD_CUBE.POS_INV_FACT_ROLLUP POS_INV_FACT_ROLLUP
0: jdbc:hive2://localhost:10016> LEFT OUTER JOIN 8N_POS_INV_DASHBOARD_CUBE.STORE_FLATTENED STORE_FLATTENED
0: jdbc:hive2://localhost:10016> ON (POS_INV_FACT_ROLLUP.WMSTRNBR = STORE_FLATTENED.WM_STR_NBR__STORE_CLEANED)
0: jdbc:hive2://localhost:10016>  JOIN 8N_POS_INV_DASHBOARD_CUBE.ITEM_FLATTEN ITEM_FLATTEN
0: jdbc:hive2://localhost:10016>   ON (POS_INV_FACT_ROLLUP.WM_ITEM_NBR = ITEM_FLATTEN.WM_ITEM_NBR)
0: jdbc:hive2://localhost:10016>   LEFT JOIN 8N_POS_INV_DASHBOARD_CUBE.WM_M_CAL_WEEK_2 WM_M_CAL_WEEK_2
0: jdbc:hive2://localhost:10016>   ON (POS_INV_FACT_ROLLUP.WM_WK = WM_M_CAL_WEEK_2.WM_WK)
0: jdbc:hive2://localhost:10016>   WHERE POS_INV_FACT_ROLLUP.sales_amt_last_wk > 10
0: jdbc:hive2://localhost:10016>   GROUP BY STORE_FLATTENED.CLX_IRI_MARKET_AREA
0: jdbc:hive2://localhost:10016> ,STORE_FLATTENED.IDR_DFLT_WHSE
0: jdbc:hive2://localhost:10016> ,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK
0: jdbc:hive2://localhost:10016> ,ITEM_FLATTEN.SUPPLIER LIMIT 100;
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
| == Physical Plan ==
CollectLimit 100
+- *HashAggregate(keys=[CLX_IRI_MARKET_AREA#55114, IDR_DFLT_WHSE#55100, SALES_AMT_LAST_WK#55030, SUPPLIER#55224], functions=[])
   +- Exchange hashpartitioning(CLX_IRI_MARKET_AREA#55114, IDR_DFLT_WHSE#55100, SALES_AMT_LAST_WK#55030, SUPPLIER#55224, 200)
      +- *HashAggregate(keys=[CLX_IRI_MARKET_AREA#55114, IDR_DFLT_WHSE#55100, SALES_AMT_LAST_WK#55030, SUPPLIER#55224], functions=[])
         +- *Project [sales_amt_last_wk#55030, idr_dflt_whse#55100, clx_iri_market_area#55114, supplier#55224]
            +- *BroadcastHashJoin [WM_WK#54976], [WM_WK#55284], LeftOuter, BuildRight
               :- *Project [sales_amt_last_wk#55030, wm_wk#54976, idr_dflt_whse#55100, clx_iri_market_area#55114, supplier#55224]
               :  +- *BroadcastHashJoin [WM_ITEM_NBR#54978], [WM_ITEM_NBR#55129], Inner, BuildRight
               :     :- *Project [wm_item_nbr#54978, sales_amt_last_wk#55030, wm_wk#54976, idr_dflt_whse#55100, clx_iri_market_area#55114]
               :     :  +- *BroadcastHashJoin [WMSTRNBR#54977], [WM_STR_NBR__STORE_CLEANED#55054], LeftOuter, BuildRight
               :     :     :- *Filter ((isnotnull(sales_amt_last_wk#55030) && (sales_amt_last_wk#55030 > 10.0)) && isnotnull(WM_ITEM_NBR#54978))
               :     :     :  +- InMemoryTableScan [wmstrnbr#54977, wm_item_nbr#54978, sales_amt_last_wk#55030, wm_wk#54976], [isnotnull(sales_amt_last_wk#55030), (sales_amt_last_wk#55030 > 10.0), isnotnull(WM_ITEM_NBR#54978)]
               :     :     :     :  +- InMemoryRelation [wmstrnbr#54977, wm_item_nbr#54978, on_hand_qty#54979, on_hand_retail_amt#54980, on_order_qty#54981, in_transit_qty#54982, in_transit_retail_amt#54983, in_whse_qty#54984, in_whse_retail_amt#54985, whse_ss_order_qty#54986, wos#54987, sales_amt#54988, sales_qty#54989, cost_amt#54990, avg_amt#54991, si_mumd_qty#54992, si_mumd_amt#54993, si_mumd_percent#54994, gross_ship_qty#54995, gross_ship_cost_amt#54996, gross_ship_avg_amt#54997, traited_str_count#54998, valid_str_count#54999, pos_str_count#55000, ... 51 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`
               :     :     :     :     :  +- HiveTableScan [wmstrnbr#43605, wm_item_nbr#43606, on_hand_qty#43607, on_hand_retail_amt#43608, on_order_qty#43609, in_transit_qty#43610, in_transit_retail_amt#43611, in_whse_qty#43612, in_whse_retail_amt#43613, whse_ss_order_qty#43614, wos#43615, sales_amt#43616, sales_qty#43617, cost_amt#43618, avg_amt#43619, si_mumd_qty#43620, si_mumd_amt#43621, si_mumd_percent#43622, gross_ship_qty#43623, gross_ship_cost_amt#43624, gross_ship_avg_amt#43625, traited_str_count#43626, valid_str_count#43627, pos_str_count#43628, ... 51 more fields], MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup
               :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :     :        +- HiveTableScan [wm_str_nbr__store_cleaned#55054, idr_dflt_whse#55100, clx_iri_market_area#55114], MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
               :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, false]))
               :        +- *Filter isnotnull(WM_ITEM_NBR#55129)
               :           +- HiveTableScan [wm_item_nbr#55129, supplier#55224], MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  +- HiveTableScan [wm_wk#55284], MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2  |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
1 row selected (0.914 seconds)