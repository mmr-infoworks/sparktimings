<!DOCTYPE html>
<!-- saved from url=(0103)https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/SQL/execution?id=68 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="./query4_files/bootstrap.min.css" type="text/css"><link rel="stylesheet" href="./query4_files/vis.min.css" type="text/css"><link rel="stylesheet" href="./query4_files/webui.css" type="text/css"><link rel="stylesheet" href="./query4_files/timeline-view.css" type="text/css"><script src="./query4_files/sorttable.js"></script><script src="./query4_files/jquery-1.11.1.min.js"></script><script src="./query4_files/vis.min.js"></script><script src="./query4_files/bootstrap-tooltip.js"></script><script src="./query4_files/initialize-tooltips.js"></script><script src="./query4_files/table.js"></script><script src="./query4_files/additional-metrics.js"></script><script src="./query4_files/timeline-view.js"></script><script src="./query4_files/log-view.js"></script>
        
        <title>org.apache.spark.sql.hive.thriftserver.HiveThriftServer2 - Details for Query 68</title>
      </head>
      <body><div id="StayFocusd-infobar" style="display:none;">
    <img src="chrome-extension://laankejkbhbdhmipfmgcngdelahlfoji/common/img/eye_19x19_red.png">
    <span id="StayFocusd-infobar-msg"></span>
    <span id="StayFocusd-infobar-links">
        <a id="StayFocusd-infobar-never-show">hide forever</a>&nbsp;&nbsp;|&nbsp;&nbsp;
        <a id="StayFocusd-infobar-hide">hide once</a>
    </span>
</div>
        <div class="navbar navbar-static-top">
          <div class="navbar-inner">
            <div class="brand">
              <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/" class="brand">
                <img src="./query4_files/spark-logo-77x50px-hd.png">
                <span class="version">2.0.2.2.5.5.3-2</span>
              </a>
            </div>
            <p class="navbar-text pull-right">
              <strong title="org.apache.spark.sql.hive.thriftserver.HiveThriftServer2">org.apache.spark.sql.hive.thrift...</strong> application UI
            </p>
            <ul class="nav"><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/">Jobs</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/stages/">Stages</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/storage/">Storage</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/environment/">Environment</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/executors/">Executors</a>
      </li><li class="active">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/SQL/">SQL</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/sqlserver/">JDBC/ODBC Server</a>
      </li></ul>
          </div>
        </div>
        <div class="container-fluid">
          <div class="row-fluid">
            <div class="span12">
              <h3 style="vertical-align: bottom; display: inline-block;">
                Details for Query 68
                
              </h3>
            </div>
          </div>
          <div>
          <ul class="unstyled">
            <li>
              <strong>Submitted Time: </strong>2017/10/28 07:05:33
            </li>
            <li>
              <strong>Duration: </strong>4 s
            </li>
            
            <li>
                <strong>Succeeded Jobs: </strong>
                <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=176">176</a><span>&nbsp;</span><a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=177">177</a><span>&nbsp;</span><a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=178">178</a><span>&nbsp;</span><a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=179">179</a><span>&nbsp;</span>
              </li>
            
          </ul>
        </div><div>
      <div id="plan-viz-graph"><svg viewBox="-21 -16 792.0859375 1523.9375" width="792.0859375" height="1523.9375"><g><g class="output"><g class="clusters"><g class="cluster_1 cluster" name="WholeStageCodegen\n\n\n0 ms (0 ms, 0 ms, 0 ms)" style="opacity: 1;"><rect width="291.609375" height="209.59375" x="23.5625" y="1213.34375" rx="5" ry="5"></rect><g class="label" text-anchor="end" transform="translate(365.328125,1239.1875)"><g transform="translate(-63.078125,-12.921875)"><text><tspan space="preserve" dy="1em" x="1">WholeStageCodegen</tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1">0 ms (0 ms, 0 ms, 0 ms)</tspan></text></g></g></g><g class="cluster_4 cluster" name="WholeStageCodegen\n\n\n2.9 m (359 ms, 872 ms, 2.0 s)" style="opacity: 1;"><rect width="321.5859375" height="1032.8125" x="-5" y="61.84375" rx="5" ry="5"></rect><g class="label" text-anchor="end" transform="translate(381.7734375,87.6875)"><g transform="translate(-78.109375,-12.921875)"><text><tspan space="preserve" dy="1em" x="1">WholeStageCodegen</tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1">2.9 m (359 ms, 872 ms, 2.0 s)</tspan></text></g></g></g><g class="cluster_17 cluster" name="WholeStageCodegen\n\n\n12 ms (1 ms, 1 ms, 2 ms)" style="opacity: 1;"><rect width="340.953125" height="138.53125" x="414.1328125" y="220.0625" rx="5" ry="5"></rect><g class="label" text-anchor="end" transform="translate(808.53125,245.90625)"><g transform="translate(-66.3671875,-12.921875)"><text><tspan space="preserve" dy="1em" x="1">WholeStageCodegen</tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1">12 ms (1 ms, 1 ms, 2 ms)</tspan></text></g></g></g></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M169.3671875,1392.9375L169.3671875,1397.1041666666667C169.3671875,1401.2708333333333,169.3671875,1409.6041666666665,169.3671875,1417.9374999999998C169.3671875,1426.2708333333333,169.3671875,1434.6041666666665,169.3671875,1442.9375C169.3671875,1451.2708333333333,169.3671875,1459.6041666666665,169.3671875,1463.7708333333333L169.3671875,1467.9375" marker-end="url(#arrowhead142)" style="fill: none;"></path><defs><marker id="arrowhead142" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M169.3671875,1199.1875L169.3671875,1203.3541666666665C169.3671875,1207.5208333333333,169.3671875,1215.8541666666665,169.3671875,1224.1875C169.3671875,1232.5208333333333,169.3671875,1240.8541666666665,169.3671875,1249.1874999999998C169.3671875,1257.5208333333333,169.3671875,1265.8541666666665,169.3671875,1270.0208333333333L169.3671875,1274.1875" marker-end="url(#arrowhead143)" style="fill: none;"></path><defs><marker id="arrowhead143" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M169.3671875,1064.65625L169.3671875,1068.8229166666665C169.3671875,1072.9895833333333,169.3671875,1081.3229166666665,169.3671875,1089.65625C169.3671875,1097.9895833333333,169.3671875,1106.3229166666665,169.3671875,1114.65625C169.3671875,1122.9895833333333,169.3671875,1131.3229166666665,169.3671875,1135.4895833333333L169.3671875,1139.65625" marker-end="url(#arrowhead144)" style="fill: none;"></path><defs><marker id="arrowhead144" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M169.3671875,895.90625L169.3671875,900.0729166666665C169.3671875,904.2395833333333,169.3671875,912.5729166666666,169.3671875,920.9062499999999C169.3671875,929.2395833333333,169.3671875,937.5729166666666,169.3671875,941.7395833333333L169.3671875,945.90625" marker-end="url(#arrowhead145)" style="fill: none;"></path><defs><marker id="arrowhead145" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M169.3671875,815.40625L169.3671875,819.5729166666665C169.3671875,823.7395833333333,169.3671875,832.0729166666665,169.3671875,840.4062499999999C169.3671875,848.7395833333333,169.3671875,857.0729166666666,169.3671875,861.2395833333333L169.3671875,865.40625" marker-end="url(#arrowhead146)" style="fill: none;"></path><defs><marker id="arrowhead146" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M159.3671875,691.359375L159.36718749999997,699.9192708333334C159.3671875,708.4791666666666,159.3671875,725.5989583333333,160.22024785402002,738.3255208333333C161.0733082080401,751.0520833333333,162.77942891608018,759.3854166666666,163.6324892701002,763.5520833333334L164.48554962412027,767.71875" marker-end="url(#arrowhead147)" style="fill: none;"></path><defs><marker id="arrowhead147" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M159.3671875,584.5L159.36718749999997,588.6666666666666C159.3671875,592.8333333333333,159.3671875,601.1666666666666,159.36718749999997,613.8932291666666C159.3671875,626.6197916666666,159.3671875,643.7395833333333,159.36718749999997,652.2994791666666L159.3671875,660.859375" marker-end="url(#arrowhead148)" style="fill: none;"></path><defs><marker id="arrowhead148" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M149.3671875,460.453125L149.3671875,469.0130208333333C149.3671875,477.57291666666663,149.3671875,494.6927083333333,150.22024785402004,507.4192708333333C151.0733082080401,520.1458333333333,152.77942891608018,528.4791666666666,153.63248927010022,532.6458333333333L154.48554962412027,536.8125" marker-end="url(#arrowhead149)" style="fill: none;"></path><defs><marker id="arrowhead149" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M149.3671875,328.59375L149.3671875,332.7604166666667C149.3671875,336.9270833333333,149.3671875,345.26041666666663,149.3671875,353.59374999999994C149.3671875,361.9270833333333,149.3671875,370.26041666666663,149.3671875,382.98697916666663C149.3671875,395.71354166666663,149.3671875,412.83333333333326,149.3671875,421.39322916666663L149.3671875,429.953125" marker-end="url(#arrowhead150)" style="fill: none;"></path><defs><marker id="arrowhead150" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M139.3671875,188.140625L139.3671875,195.26822916666666C139.3671875,202.39583333333331,139.3671875,216.65104166666666,139.3671875,227.9453125C139.3671875,239.23958333333331,139.3671875,247.57291666666666,140.22024785402004,255.90625C141.0733082080401,264.2395833333333,142.77942891608018,272.57291666666663,143.63248927010022,276.7395833333333L144.48554962412027,280.90625" marker-end="url(#arrowhead151)" style="fill: none;"></path><defs><marker id="arrowhead151" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M139.3671875,47.6875L139.3671875,51.85416666666666C139.3671875,56.02083333333333,139.3671875,64.35416666666666,139.3671875,72.6875C139.3671875,81.02083333333333,139.3671875,89.35416666666666,139.3671875,100.6484375C139.3671875,111.94270833333333,139.3671875,126.19791666666666,139.3671875,133.32552083333331L139.3671875,140.453125" marker-end="url(#arrowhead152)" style="fill: none;"></path><defs><marker id="arrowhead152" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M346.5859375,187.45602792234536L323.90104166666663,194.69773160195444C301.2161458333333,201.93943528156356,255.84635416666663,216.42284264078177,233.16145833333331,227.83121298705754C210.47656249999997,239.23958333333331,210.47656249999997,247.57291666666666,205.26356399285558,255.90625C200.05056548571122,264.2395833333333,189.62456847142246,272.57291666666663,184.41156996427807,276.7395833333333L179.1985714571337,280.90625" marker-end="url(#arrowhead153)" style="fill: none;"></path><defs><marker id="arrowhead153" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M419.1328125,47.6875L419.1328125,51.85416666666666C419.1328125,56.02083333333333,419.1328125,64.35416666666666,419.1328125,72.6875C419.1328125,81.02083333333333,419.1328125,89.35416666666666,419.1328125,97.6875C419.1328125,106.02083333333333,419.1328125,114.35416666666666,419.1328125,118.52083333333331L419.1328125,122.6875" marker-end="url(#arrowhead154)" style="fill: none;"></path><defs><marker id="arrowhead154" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M550.8984375,457.85599754366814L495.828125,466.8487479530567C440.7578125,475.84149836244535,330.6171875,493.8269991812227,270.3338764928556,506.986416257278C210.05056548571122,520.1458333333333,199.62456847142246,528.4791666666666,194.41156996427807,532.6458333333333L189.1985714571337,536.8125" marker-end="url(#arrowhead155)" style="fill: none;"></path><defs><marker id="arrowhead155" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M628.3828125,328.59375L628.3828125,332.7604166666667C628.3828125,336.9270833333333,628.3828125,345.26041666666663,628.3828125,353.59374999999994C628.3828125,361.9270833333333,628.3828125,370.26041666666663,628.3828125,378.59375C628.3828125,386.9270833333333,628.3828125,395.26041666666663,628.3828125,399.4270833333333L628.3828125,403.59375" marker-end="url(#arrowhead156)" style="fill: none;"></path><defs><marker id="arrowhead156" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M628.3828125,188.140625L628.3828125,195.26822916666666C628.3828125,202.39583333333331,628.3828125,216.65104166666666,628.3828125,227.9453125C628.3828125,239.23958333333331,628.3828125,247.57291666666666,628.3828125,255.90625C628.3828125,264.2395833333333,628.3828125,272.57291666666663,628.3828125,276.7395833333333L628.3828125,280.90625" marker-end="url(#arrowhead157)" style="fill: none;"></path><defs><marker id="arrowhead157" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M359.09375,699.7808847497944L337.6575520833333,706.9371956248286C316.22135416666663,714.0935064998629,273.3489583333333,728.4061282499315,246.6997619095223,739.7291057916324C220.05056548571122,751.0520833333333,209.62456847142244,759.3854166666666,204.41156996427804,763.5520833333334L199.1985714571337,767.71875" marker-end="url(#arrowhead158)" style="fill: none;"></path><defs><marker id="arrowhead158" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M430,584.5L429.9999999999999,588.6666666666666C429.99999999999994,592.8333333333333,429.99999999999994,601.1666666666666,429.9999999999999,609.5C429.99999999999994,617.8333333333333,429.99999999999994,626.1666666666666,429.9999999999999,630.3333333333334L430,634.5" marker-end="url(#arrowhead159)" style="fill: none;"></path><defs><marker id="arrowhead159" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g></g><g class="nodes"><g class="node_0 node" name="CollectLimit" transform="translate(169.3671875,1479.9375)" style="opacity: 1;"><rect rx="5" ry="5" x="-38.9453125" y="-12" width="77.890625" height="24"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-33.9453125,-7)"><text><tspan space="preserve" dy="1em" x="1">CollectLimit</tspan></text></g></g></g><g class="node_2 node" name="HashAggregate\n \nnumber of output rows: 101\npeak memory total (min, med, max): \n66.0 MB (66.0 MB, 66.0 MB, 66.0 MB)\nspill size total (min, med, max): \n0.0 B (0.0 B, 0.0 B, 0.0 B)\naggregate time total (min, med, max): \n148 ms (148 ms, 148 ms, 148 ms)" transform="translate(169.3671875,1333.5625)" style="opacity: 1;"><rect rx="5" ry="5" x="-105.8046875" y="-59.375" width="211.609375" height="118.75"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-100.8046875,-54.375)"><text><tspan space="preserve" dy="1em" x="1">HashAggregate</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 101</tspan><tspan space="preserve" dy="1em" x="1">peak memory total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">66.0 MB (66.0 MB, 66.0 MB, 66.0 MB)</tspan><tspan space="preserve" dy="1em" x="1">spill size total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">0.0 B (0.0 B, 0.0 B, 0.0 B)</tspan><tspan space="preserve" dy="1em" x="1">aggregate time total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">148 ms (148 ms, 148 ms, 148 ms)</tspan></text></g></g><g></g></g><g class="node_3 node" name="Exchange\n \ndata size total (min, med, max): \n6.1 GB (671.0 B, 34.1 MB, 51.0 MB)" transform="translate(169.3671875,1169.421875)" style="opacity: 1;"><rect rx="5" ry="5" x="-99.984375" y="-29.765625" width="199.96875" height="59.53125"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-94.984375,-24.765625)"><text><tspan space="preserve" dy="1em" x="1">Exchange</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">data size total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">6.1 GB (671.0 B, 34.1 MB, 51.0 MB)</tspan></text></g></g></g><g class="node_5 node" name="HashAggregate\n \nnumber of output rows: 61,452,954\npeak memory total (min, med, max): \n14.2 GB (256.0 KB, 80.0 MB, 96.0 MB)\nspill size total (min, med, max): \n0.0 B (0.0 B, 0.0 B, 0.0 B)\naggregate time total (min, med, max): \n2.1 m (358 ms, 635 ms, 1.7 s)" transform="translate(169.3671875,1005.28125)" style="opacity: 1;"><rect rx="5" ry="5" x="-107.21875" y="-59.375" width="214.4375" height="118.75"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-102.21875,-54.375)"><text><tspan space="preserve" dy="1em" x="1">HashAggregate</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 61,452,954</tspan><tspan space="preserve" dy="1em" x="1">peak memory total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">14.2 GB (256.0 KB, 80.0 MB, 96.0 MB)</tspan><tspan space="preserve" dy="1em" x="1">spill size total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">0.0 B (0.0 B, 0.0 B, 0.0 B)</tspan><tspan space="preserve" dy="1em" x="1">aggregate time total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">2.1 m (358 ms, 635 ms, 1.7 s)</tspan></text></g></g><g></g></g><g class="node_6 node" name="Project" transform="translate(169.3671875,880.65625)" style="opacity: 1;"><rect rx="5" ry="5" x="-25.28125" y="-12" width="50.5625" height="24"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.28125,-7)"><text><tspan space="preserve" dy="1em" x="1">Project</tspan></text></g></g><g></g></g><g class="node_7 node" name="BroadcastHashJoin\n \nnumber of output rows: 123,653,086" transform="translate(169.3671875,791.5625)" style="opacity: 1;"><rect rx="5" ry="5" x="-101.515625" y="-23.84375" width="203.03125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-96.515625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastHashJoin</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 123,653,086</tspan></text></g></g><g></g></g><g class="node_8 node" name="Project" transform="translate(159.3671875,676.109375)" style="opacity: 1;"><rect rx="5" ry="5" x="-25.28125" y="-12" width="50.5625" height="24"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.28125,-7)"><text><tspan space="preserve" dy="1em" x="1">Project</tspan></text></g></g><g></g></g><g class="node_9 node" name="BroadcastHashJoin\n \nnumber of output rows: 123,653,086" transform="translate(159.3671875,560.65625)" style="opacity: 1;"><rect rx="5" ry="5" x="-101.515625" y="-23.84375" width="203.03125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-96.515625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastHashJoin</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 123,653,086</tspan></text></g></g><g></g></g><g class="node_10 node" name="Project" transform="translate(149.3671875,445.203125)" style="opacity: 1;"><rect rx="5" ry="5" x="-25.28125" y="-12" width="50.5625" height="24"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.28125,-7)"><text><tspan space="preserve" dy="1em" x="1">Project</tspan></text></g></g><g></g></g><g class="node_11 node" name="BroadcastHashJoin\n \nnumber of output rows: 130,979,952" transform="translate(149.3671875,304.75)" style="opacity: 1;"><rect rx="5" ry="5" x="-101.515625" y="-23.84375" width="203.03125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-96.515625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastHashJoin</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 130,979,952</tspan></text></g></g><g></g></g><g class="node_12 node" name="Filter\n \nnumber of output rows: 130,979,952" transform="translate(139.3671875,164.296875)" style="opacity: 1;"><rect rx="5" ry="5" x="-101.515625" y="-23.84375" width="203.03125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-96.515625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">Filter</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 130,979,952</tspan></text></g></g><g></g></g><g class="node_13 node" name="InMemoryTableScan\n \nnumber of output rows: 270,711,204" transform="translate(139.3671875,23.84375)" style="opacity: 1;"><rect rx="5" ry="5" x="-101.515625" y="-23.84375" width="203.03125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-96.515625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">InMemoryTableScan</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 270,711,204</tspan></text></g></g></g><g class="node_14 node" name="BroadcastExchange\n \ndata size (bytes): 389,360\ntime to collect (ms): 396\ntime to build (ms): 1\ntime to broadcast (ms): 4" transform="translate(419.1328125,164.296875)" style="opacity: 1;"><rect rx="5" ry="5" x="-72.546875" y="-41.609375" width="145.09375" height="83.21875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-67.546875,-36.609375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastExchange</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">data size (bytes): 389,360</tspan><tspan space="preserve" dy="1em" x="1">time to collect (ms): 396</tspan><tspan space="preserve" dy="1em" x="1">time to build (ms): 1</tspan><tspan space="preserve" dy="1em" x="1">time to broadcast (ms): 4</tspan></text></g></g></g><g class="node_15 node" name="HiveTableScan\n \nnumber of output rows: 5,623" transform="translate(419.1328125,23.84375)" style="opacity: 1;" data-original-title="" title=""><rect rx="5" ry="5" x="-83.4140625" y="-23.84375" width="166.828125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-78.4140625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">HiveTableScan</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 5,623</tspan></text></g></g></g><g class="node_16 node" name="BroadcastExchange\n \ndata size (bytes): 1,023,032\ntime to collect (ms): 387\ntime to build (ms): 5\ntime to broadcast (ms): 9" transform="translate(628.3828125,445.203125)" style="opacity: 1;"><rect rx="5" ry="5" x="-77.484375" y="-41.609375" width="154.96875" height="83.21875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-72.484375,-36.609375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastExchange</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">data size (bytes): 1,023,032</tspan><tspan space="preserve" dy="1em" x="1">time to collect (ms): 387</tspan><tspan space="preserve" dy="1em" x="1">time to build (ms): 5</tspan><tspan space="preserve" dy="1em" x="1">time to broadcast (ms): 9</tspan></text></g></g></g><g class="node_18 node" name="Filter\n \nnumber of output rows: 19,486" transform="translate(628.3828125,304.75)" style="opacity: 1;"><rect rx="5" ry="5" x="-86.703125" y="-23.84375" width="173.40625" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-81.703125,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">Filter</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 19,486</tspan></text></g></g><g></g></g><g class="node_19 node" name="HiveTableScan\n \nnumber of output rows: 19,486" transform="translate(628.3828125,164.296875)" style="opacity: 1;"><rect rx="5" ry="5" x="-86.703125" y="-23.84375" width="173.40625" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-81.703125,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">HiveTableScan</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 19,486</tspan></text></g></g></g><g class="node_20 node" name="BroadcastExchange\n \ndata size (bytes): 16,640\ntime to collect (ms): 383\ntime to build (ms): 1\ntime to broadcast (ms): 3" transform="translate(430,676.109375)" style="opacity: 1;"><rect rx="5" ry="5" x="-70.90625" y="-41.609375" width="141.8125" height="83.21875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-65.90625,-36.609375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastExchange</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">data size (bytes): 16,640</tspan><tspan space="preserve" dy="1em" x="1">time to collect (ms): 383</tspan><tspan space="preserve" dy="1em" x="1">time to build (ms): 1</tspan><tspan space="preserve" dy="1em" x="1">time to broadcast (ms): 3</tspan></text></g></g></g><g class="node_21 node" name="HiveTableScan\n \nnumber of output rows: 1,040" transform="translate(430,560.65625)" style="opacity: 1;"><rect rx="5" ry="5" x="-83.4140625" y="-23.84375" width="166.828125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-78.4140625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">HiveTableScan</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 1,040</tspan></text></g></g></g></g></g></g></svg></div>
      <div id="plan-viz-metadata" style="display:none">
        <div class="dot-file">
          digraph G {
  0 [label="CollectLimit"];

  subgraph cluster1 {
    label="WholeStageCodegen\n\n\n0 ms (0 ms, 0 ms, 0 ms)";
      2 [label="HashAggregate\n \nnumber of output rows: 101\npeak memory total (min, med, max): \n66.0 MB (66.0 MB, 66.0 MB, 66.0 MB)\nspill size total (min, med, max): \n0.0 B (0.0 B, 0.0 B, 0.0 B)\naggregate time total (min, med, max): \n148 ms (148 ms, 148 ms, 148 ms)"];
  }
     
  3 [label="Exchange\n \ndata size total (min, med, max): \n6.1 GB (671.0 B, 34.1 MB, 51.0 MB)"];

  subgraph cluster4 {
    label="WholeStageCodegen\n\n\n2.9 m (359 ms, 872 ms, 2.0 s)";
      5 [label="HashAggregate\n \nnumber of output rows: 61,452,954\npeak memory total (min, med, max): \n14.2 GB (256.0 KB, 80.0 MB, 96.0 MB)\nspill size total (min, med, max): \n0.0 B (0.0 B, 0.0 B, 0.0 B)\naggregate time total (min, med, max): \n2.1 m (358 ms, 635 ms, 1.7 s)"];    
  6 [label="Project"];    
  7 [label="BroadcastHashJoin\n \nnumber of output rows: 123,653,086"];    
  8 [label="Project"];    
  9 [label="BroadcastHashJoin\n \nnumber of output rows: 123,653,086"];    
  10 [label="Project"];    
  11 [label="BroadcastHashJoin\n \nnumber of output rows: 130,979,952"];    
  12 [label="Filter\n \nnumber of output rows: 130,979,952"];
  }
     
  13 [label="InMemoryTableScan\n \nnumber of output rows: 270,711,204"];
  14 [label="BroadcastExchange\n \ndata size (bytes): 389,360\ntime to collect (ms): 396\ntime to build (ms): 1\ntime to broadcast (ms): 4"];
  15 [label="HiveTableScan\n \nnumber of output rows: 5,623"];
  16 [label="BroadcastExchange\n \ndata size (bytes): 1,023,032\ntime to collect (ms): 387\ntime to build (ms): 5\ntime to broadcast (ms): 9"];

  subgraph cluster17 {
    label="WholeStageCodegen\n\n\n12 ms (1 ms, 1 ms, 2 ms)";
      18 [label="Filter\n \nnumber of output rows: 19,486"];
  }
     
  19 [label="HiveTableScan\n \nnumber of output rows: 19,486"];
  20 [label="BroadcastExchange\n \ndata size (bytes): 16,640\ntime to collect (ms): 383\ntime to build (ms): 1\ntime to broadcast (ms): 3"];
  21 [label="HiveTableScan\n \nnumber of output rows: 1,040"];
  2-&gt;0;

  3-&gt;2;

  5-&gt;3;

  6-&gt;5;

  7-&gt;6;

  8-&gt;7;

  9-&gt;8;

  10-&gt;9;

  11-&gt;10;

  12-&gt;11;

  13-&gt;12;

  14-&gt;11;

  15-&gt;14;

  16-&gt;9;

  18-&gt;16;

  19-&gt;18;

  20-&gt;7;

  21-&gt;20;

}
        </div>
        <div id="plan-viz-metadata-size">22</div>
        <div id="plan-meta-data-0">CollectLimit 100</div><div id="plan-meta-data-2">HashAggregate(keys=[CLX_IRI_MARKET_AREA#56563, IDR_DFLT_WHSE#56549, SALES_AMT_LAST_WK#56479, SUPPLIER#56673], functions=[])</div><div id="plan-meta-data-1">WholeStageCodegen</div><div id="plan-meta-data-3">Exchange hashpartitioning(CLX_IRI_MARKET_AREA#56563, IDR_DFLT_WHSE#56549, SALES_AMT_LAST_WK#56479, SUPPLIER#56673, 200)</div><div id="plan-meta-data-5">HashAggregate(keys=[CLX_IRI_MARKET_AREA#56563, IDR_DFLT_WHSE#56549, SALES_AMT_LAST_WK#56479, SUPPLIER#56673], functions=[])</div><div id="plan-meta-data-6">Project [sales_amt_last_wk#56479, idr_dflt_whse#56549, clx_iri_market_area#56563, supplier#56673]</div><div id="plan-meta-data-7">BroadcastHashJoin [WM_WK#56425], [WM_WK#56733], LeftOuter, BuildRight</div><div id="plan-meta-data-8">Project [sales_amt_last_wk#56479, wm_wk#56425, idr_dflt_whse#56549, clx_iri_market_area#56563, supplier#56673]</div><div id="plan-meta-data-9">BroadcastHashJoin [WM_ITEM_NBR#56427], [WM_ITEM_NBR#56578], Inner, BuildRight</div><div id="plan-meta-data-10">Project [wm_item_nbr#56427, sales_amt_last_wk#56479, wm_wk#56425, idr_dflt_whse#56549, clx_iri_market_area#56563]</div><div id="plan-meta-data-11">BroadcastHashJoin [WMSTRNBR#56426], [WM_STR_NBR__STORE_CLEANED#56503], LeftOuter, BuildRight</div><div id="plan-meta-data-12">Filter ((isnotnull(sales_amt_last_wk#56479) &amp;&amp; (sales_amt_last_wk#56479 &gt; 10.0)) &amp;&amp; isnotnull(WM_ITEM_NBR#56427))</div><div id="plan-meta-data-4">WholeStageCodegen</div><div id="plan-meta-data-13">InMemoryTableScan [wmstrnbr#56426, wm_item_nbr#56427, sales_amt_last_wk#56479, wm_wk#56425], [isnotnull(sales_amt_last_wk#56479), (sales_amt_last_wk#56479 &gt; 10.0), isnotnull(WM_ITEM_NBR#56427)]</div><div id="plan-meta-data-14">BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))</div><div id="plan-meta-data-15">HiveTableScan [wm_str_nbr__store_cleaned#56503, idr_dflt_whse#56549, clx_iri_market_area#56563], MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED</div><div id="plan-meta-data-16">BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, false]))</div><div id="plan-meta-data-18">Filter isnotnull(WM_ITEM_NBR#56578)</div><div id="plan-meta-data-17">WholeStageCodegen</div><div id="plan-meta-data-19">HiveTableScan [wm_item_nbr#56578, supplier#56673], MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN</div><div id="plan-meta-data-20">BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))</div><div id="plan-meta-data-21">HiveTableScan [wm_wk#56733], MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2</div>
      </div>
      <link rel="stylesheet" href="./query4_files/spark-sql-viz.css" type="text/css"><script src="./query4_files/d3.min.js"></script><script src="./query4_files/dagre-d3.min.js"></script><script src="./query4_files/graphlib-dot.min.js"></script><script src="./query4_files/spark-sql-viz.js"></script>
      <script>$(function() { renderPlanViz(); })</script>
    </div><div>
      <span style="cursor: pointer;" onclick="clickPhysicalPlanDetails();">
        <span id="physical-plan-details-arrow" class="arrow-closed"></span>
        <a>Details</a>
      </span>
    </div><div id="physical-plan-details" style="display: none;">
      <pre>== Parsed Logical Plan ==
'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Aggregate ['STORE_FLATTENED.CLX_IRI_MARKET_AREA, 'STORE_FLATTENED.IDR_DFLT_WHSE, 'POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK, 'ITEM_FLATTEN.SUPPLIER], ['STORE_FLATTENED.CLX_IRI_MARKET_AREA AS CLX_IRI_MARKET_AREA#56064, 'STORE_FLATTENED.IDR_DFLT_WHSE AS IDR_DFLT_WHSE#56065, 'POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK AS SALES_AMT_LAST_WK#56066, 'ITEM_FLATTEN.SUPPLIER AS SUPPLIER#56067]
      +- 'Filter ('POS_INV_FACT_ROLLUP.sales_amt_last_wk &gt; 10)
         +- 'Join LeftOuter, ('POS_INV_FACT_ROLLUP.WM_WK = 'WM_M_CAL_WEEK_2.WM_WK)
            :- 'Join Inner, ('POS_INV_FACT_ROLLUP.WM_ITEM_NBR = 'ITEM_FLATTEN.WM_ITEM_NBR)
            :  :- 'Join LeftOuter, ('POS_INV_FACT_ROLLUP.WMSTRNBR = 'STORE_FLATTENED.WM_STR_NBR__STORE_CLEANED)
            :  :  :- 'UnresolvedRelation `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`, POS_INV_FACT_ROLLUP
            :  :  +- 'UnresolvedRelation `8N_POS_INV_DASHBOARD_CUBE`.`STORE_FLATTENED`, STORE_FLATTENED
            :  +- 'UnresolvedRelation `8N_POS_INV_DASHBOARD_CUBE`.`ITEM_FLATTEN`, ITEM_FLATTEN
            +- 'UnresolvedRelation `8N_POS_INV_DASHBOARD_CUBE`.`WM_M_CAL_WEEK_2`, WM_M_CAL_WEEK_2

== Analyzed Logical Plan ==
CLX_IRI_MARKET_AREA: string, IDR_DFLT_WHSE: string, SALES_AMT_LAST_WK: double, SUPPLIER: string
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [CLX_IRI_MARKET_AREA#56563, IDR_DFLT_WHSE#56549, SALES_AMT_LAST_WK#56479, SUPPLIER#56673], [CLX_IRI_MARKET_AREA#56563 AS CLX_IRI_MARKET_AREA#56064, IDR_DFLT_WHSE#56549 AS IDR_DFLT_WHSE#56065, SALES_AMT_LAST_WK#56479 AS SALES_AMT_LAST_WK#56066, SUPPLIER#56673 AS SUPPLIER#56067]
      +- Filter (sales_amt_last_wk#56479 &gt; cast(10 as double))
         +- Join LeftOuter, (WM_WK#56425 = WM_WK#56733)
            :- Join Inner, (WM_ITEM_NBR#56427 = WM_ITEM_NBR#56578)
            :  :- Join LeftOuter, (WMSTRNBR#56426 = WM_STR_NBR__STORE_CLEANED#56503)
            :  :  :- MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup, POS_INV_FACT_ROLLUP
            :  :  +- MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
            :  +- MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
            +- MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [CLX_IRI_MARKET_AREA#56563, IDR_DFLT_WHSE#56549, SALES_AMT_LAST_WK#56479, SUPPLIER#56673], [CLX_IRI_MARKET_AREA#56563 AS CLX_IRI_MARKET_AREA#56064, IDR_DFLT_WHSE#56549 AS IDR_DFLT_WHSE#56065, SALES_AMT_LAST_WK#56479 AS SALES_AMT_LAST_WK#56066, SUPPLIER#56673 AS SUPPLIER#56067]
      +- Project [sales_amt_last_wk#56479, idr_dflt_whse#56549, clx_iri_market_area#56563, supplier#56673]
         +- Join LeftOuter, (WM_WK#56425 = WM_WK#56733)
            :- Project [sales_amt_last_wk#56479, wm_wk#56425, idr_dflt_whse#56549, clx_iri_market_area#56563, supplier#56673]
            :  +- Join Inner, (WM_ITEM_NBR#56427 = WM_ITEM_NBR#56578)
            :     :- Project [wm_item_nbr#56427, sales_amt_last_wk#56479, wm_wk#56425, idr_dflt_whse#56549, clx_iri_market_area#56563]
            :     :  +- Join LeftOuter, (WMSTRNBR#56426 = WM_STR_NBR__STORE_CLEANED#56503)
            :     :     :- Project [wmstrnbr#56426, wm_item_nbr#56427, sales_amt_last_wk#56479, wm_wk#56425]
            :     :     :  +- Filter ((isnotnull(sales_amt_last_wk#56479) &amp;&amp; (sales_amt_last_wk#56479 &gt; 10.0)) &amp;&amp; isnotnull(WM_ITEM_NBR#56427))
            :     :     :     +- InMemoryRelation [wmstrnbr#56426, wm_item_nbr#56427, on_hand_qty#56428, on_hand_retail_amt#56429, on_order_qty#56430, in_transit_qty#56431, in_transit_retail_amt#56432, in_whse_qty#56433, in_whse_retail_amt#56434, whse_ss_order_qty#56435, wos#56436, sales_amt#56437, sales_qty#56438, cost_amt#56439, avg_amt#56440, si_mumd_qty#56441, si_mumd_amt#56442, si_mumd_percent#56443, gross_ship_qty#56444, gross_ship_cost_amt#56445, gross_ship_avg_amt#56446, traited_str_count#56447, valid_str_count#56448, pos_str_count#56449, ... 51 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`
            :     :     :        :  +- HiveTableScan [wmstrnbr#43605, wm_item_nbr#43606, on_hand_qty#43607, on_hand_retail_amt#43608, on_order_qty#43609, in_transit_qty#43610, in_transit_retail_amt#43611, in_whse_qty#43612, in_whse_retail_amt#43613, whse_ss_order_qty#43614, wos#43615, sales_amt#43616, sales_qty#43617, cost_amt#43618, avg_amt#43619, si_mumd_qty#43620, si_mumd_amt#43621, si_mumd_percent#43622, gross_ship_qty#43623, gross_ship_cost_amt#43624, gross_ship_avg_amt#43625, traited_str_count#43626, valid_str_count#43627, pos_str_count#43628, ... 51 more fields], MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup
            :     :     +- Project [wm_str_nbr__store_cleaned#56503, idr_dflt_whse#56549, clx_iri_market_area#56563]
            :     :        +- MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
            :     +- Project [wm_item_nbr#56578, supplier#56673]
            :        +- Filter isnotnull(WM_ITEM_NBR#56578)
            :           +- MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
            +- Project [wm_wk#56733]
               +- MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2

== Physical Plan ==
CollectLimit 100
+- *HashAggregate(keys=[CLX_IRI_MARKET_AREA#56563, IDR_DFLT_WHSE#56549, SALES_AMT_LAST_WK#56479, SUPPLIER#56673], functions=[], output=[CLX_IRI_MARKET_AREA#56064, IDR_DFLT_WHSE#56065, SALES_AMT_LAST_WK#56066, SUPPLIER#56067])
   +- Exchange hashpartitioning(CLX_IRI_MARKET_AREA#56563, IDR_DFLT_WHSE#56549, SALES_AMT_LAST_WK#56479, SUPPLIER#56673, 200)
      +- *HashAggregate(keys=[CLX_IRI_MARKET_AREA#56563, IDR_DFLT_WHSE#56549, SALES_AMT_LAST_WK#56479, SUPPLIER#56673], functions=[], output=[CLX_IRI_MARKET_AREA#56563, IDR_DFLT_WHSE#56549, SALES_AMT_LAST_WK#56479, SUPPLIER#56673])
         +- *Project [sales_amt_last_wk#56479, idr_dflt_whse#56549, clx_iri_market_area#56563, supplier#56673]
            +- *BroadcastHashJoin [WM_WK#56425], [WM_WK#56733], LeftOuter, BuildRight
               :- *Project [sales_amt_last_wk#56479, wm_wk#56425, idr_dflt_whse#56549, clx_iri_market_area#56563, supplier#56673]
               :  +- *BroadcastHashJoin [WM_ITEM_NBR#56427], [WM_ITEM_NBR#56578], Inner, BuildRight
               :     :- *Project [wm_item_nbr#56427, sales_amt_last_wk#56479, wm_wk#56425, idr_dflt_whse#56549, clx_iri_market_area#56563]
               :     :  +- *BroadcastHashJoin [WMSTRNBR#56426], [WM_STR_NBR__STORE_CLEANED#56503], LeftOuter, BuildRight
               :     :     :- *Filter ((isnotnull(sales_amt_last_wk#56479) &amp;&amp; (sales_amt_last_wk#56479 &gt; 10.0)) &amp;&amp; isnotnull(WM_ITEM_NBR#56427))
               :     :     :  +- InMemoryTableScan [wmstrnbr#56426, wm_item_nbr#56427, sales_amt_last_wk#56479, wm_wk#56425], [isnotnull(sales_amt_last_wk#56479), (sales_amt_last_wk#56479 &gt; 10.0), isnotnull(WM_ITEM_NBR#56427)]
               :     :     :     :  +- InMemoryRelation [wmstrnbr#56426, wm_item_nbr#56427, on_hand_qty#56428, on_hand_retail_amt#56429, on_order_qty#56430, in_transit_qty#56431, in_transit_retail_amt#56432, in_whse_qty#56433, in_whse_retail_amt#56434, whse_ss_order_qty#56435, wos#56436, sales_amt#56437, sales_qty#56438, cost_amt#56439, avg_amt#56440, si_mumd_qty#56441, si_mumd_amt#56442, si_mumd_percent#56443, gross_ship_qty#56444, gross_ship_cost_amt#56445, gross_ship_avg_amt#56446, traited_str_count#56447, valid_str_count#56448, pos_str_count#56449, ... 51 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`
               :     :     :     :     :  +- HiveTableScan [wmstrnbr#43605, wm_item_nbr#43606, on_hand_qty#43607, on_hand_retail_amt#43608, on_order_qty#43609, in_transit_qty#43610, in_transit_retail_amt#43611, in_whse_qty#43612, in_whse_retail_amt#43613, whse_ss_order_qty#43614, wos#43615, sales_amt#43616, sales_qty#43617, cost_amt#43618, avg_amt#43619, si_mumd_qty#43620, si_mumd_amt#43621, si_mumd_percent#43622, gross_ship_qty#43623, gross_ship_cost_amt#43624, gross_ship_avg_amt#43625, traited_str_count#43626, valid_str_count#43627, pos_str_count#43628, ... 51 more fields], MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup
               :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :     :        +- HiveTableScan [wm_str_nbr__store_cleaned#56503, idr_dflt_whse#56549, clx_iri_market_area#56563], MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
               :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, false]))
               :        +- *Filter isnotnull(WM_ITEM_NBR#56578)
               :           +- HiveTableScan [wm_item_nbr#56578, supplier#56673], MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  +- HiveTableScan [wm_wk#56733], MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2</pre>
    </div><script>
      function clickPhysicalPlanDetails() {
        $('#physical-plan-details').toggle();
        $('#physical-plan-details-arrow').toggleClass('arrow-open').toggleClass('arrow-closed');
      }
    </script><br>
        </div>
      
    </body></html>