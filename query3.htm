<!DOCTYPE html>
<!-- saved from url=(0103)https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/SQL/execution?id=65 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="./query3_files/bootstrap.min.css" type="text/css"><link rel="stylesheet" href="./query3_files/vis.min.css" type="text/css"><link rel="stylesheet" href="./query3_files/webui.css" type="text/css"><link rel="stylesheet" href="./query3_files/timeline-view.css" type="text/css"><script src="./query3_files/sorttable.js"></script><script src="./query3_files/jquery-1.11.1.min.js"></script><script src="./query3_files/vis.min.js"></script><script src="./query3_files/bootstrap-tooltip.js"></script><script src="./query3_files/initialize-tooltips.js"></script><script src="./query3_files/table.js"></script><script src="./query3_files/additional-metrics.js"></script><script src="./query3_files/timeline-view.js"></script><script src="./query3_files/log-view.js"></script>
        
        <title>org.apache.spark.sql.hive.thriftserver.HiveThriftServer2 - Details for Query 65</title>
      </head>
      <body><div id="StayFocusd-infobar" style="display: none; top: 983px;">
    <img src="chrome-extension://laankejkbhbdhmipfmgcngdelahlfoji/common/img/eye_19x19_red.png">
    <span id="StayFocusd-infobar-msg"></span>
    <span id="StayFocusd-infobar-links">
        <a id="StayFocusd-infobar-never-show">hide forever</a>&nbsp;&nbsp;|&nbsp;&nbsp;
        <a id="StayFocusd-infobar-hide">hide once</a>
    </span>
</div>
        <div class="navbar navbar-static-top">
          <div class="navbar-inner">
            <div class="brand">
              <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/" class="brand">
                <img src="./query3_files/spark-logo-77x50px-hd.png">
                <span class="version">2.0.2.2.5.5.3-2</span>
              </a>
            </div>
            <p class="navbar-text pull-right">
              <strong title="org.apache.spark.sql.hive.thriftserver.HiveThriftServer2">org.apache.spark.sql.hive.thrift...</strong> application UI
            </p>
            <ul class="nav"><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/">Jobs</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/stages/">Stages</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/storage/">Storage</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/environment/">Environment</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/executors/">Executors</a>
      </li><li class="active">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/SQL/">SQL</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/sqlserver/">JDBC/ODBC Server</a>
      </li></ul>
          </div>
        </div>
        <div class="container-fluid">
          <div class="row-fluid">
            <div class="span12">
              <h3 style="vertical-align: bottom; display: inline-block;">
                Details for Query 65
                
              </h3>
            </div>
          </div>
          <div>
          <ul class="unstyled">
            <li>
              <strong>Submitted Time: </strong>2017/10/28 07:00:31
            </li>
            <li>
              <strong>Duration: </strong>7 s
            </li>
            
            <li>
                <strong>Succeeded Jobs: </strong>
                <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=171">171</a><span>&nbsp;</span><a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=172">172</a><span>&nbsp;</span><a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=173">173</a><span>&nbsp;</span><a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=174">174</a><span>&nbsp;</span><a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=175">175</a><span>&nbsp;</span>
              </li>
            
          </ul>
        </div><div>
      <div id="plan-viz-graph"><svg viewBox="-21 -16 790.92578125 1621.625" width="790.92578125" height="1621.625"><g><g class="output"><g class="clusters"><g class="cluster_1 cluster" name="WholeStageCodegen\n\n\n48 ms (0 ms, 0 ms, 13 ms)" style="opacity: 1;"><rect width="304.765625" height="209.59375" x="6.94140625" y="1311.03125" rx="5" ry="5"></rect><g class="label" text-anchor="end" transform="translate(368.44921875,1336.875)"><g transform="translate(-69.6640625,-12.921875)"><text><tspan space="preserve" dy="1em" x="1">WholeStageCodegen</tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1">48 ms (0 ms, 0 ms, 13 ms)</tspan></text></g></g></g><g class="cluster_4 cluster" name="WholeStageCodegen\n\n\n5.8 m (732 ms, 1.6 s, 4.3 s)" style="opacity: 1;"><rect width="309.55859375" height="1130.5" x="-5" y="61.84375" rx="5" ry="5"></rect><g class="label" text-anchor="end" transform="translate(363.05078125,87.6875)"><g transform="translate(-71.4140625,-12.921875)"><text><tspan space="preserve" dy="1em" x="1">WholeStageCodegen</tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1">5.8 m (732 ms, 1.6 s, 4.3 s)</tspan></text></g></g></g><g class="cluster_18 cluster" name="WholeStageCodegen\n\n\n12 ms (1 ms, 1 ms, 2 ms)" style="opacity: 1;"><rect width="346.38671875" height="138.53125" x="407.5390625" y="317.75" rx="5" ry="5"></rect><g class="label" text-anchor="end" transform="translate(807.37109375,343.59375)"><g transform="translate(-66.3671875,-12.921875)"><text><tspan space="preserve" dy="1em" x="1">WholeStageCodegen</tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1">12 ms (1 ms, 1 ms, 2 ms)</tspan></text></g></g></g></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M159.32421875,1490.625L159.32421875,1494.7916666666667C159.32421875,1498.9583333333333,159.32421875,1507.2916666666665,159.32421875,1515.6249999999998C159.32421875,1523.9583333333333,159.32421875,1532.2916666666665,159.32421875,1540.625C159.32421875,1548.9583333333333,159.32421875,1557.2916666666665,159.32421875,1561.4583333333333L159.32421875,1565.625" marker-end="url(#arrowhead150)" style="fill: none;"></path><defs><marker id="arrowhead150" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M159.32421875,1296.875L159.32421875,1301.0416666666665C159.32421875,1305.2083333333333,159.32421875,1313.5416666666665,159.32421875,1321.875C159.32421875,1330.2083333333333,159.32421875,1338.5416666666665,159.32421875,1346.8749999999998C159.32421875,1355.2083333333333,159.32421875,1363.5416666666665,159.32421875,1367.7083333333333L159.32421875,1371.875" marker-end="url(#arrowhead151)" style="fill: none;"></path><defs><marker id="arrowhead151" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M159.32421875,1162.34375L159.32421875,1166.5104166666665C159.32421875,1170.6770833333333,159.32421875,1179.0104166666665,159.32421875,1187.34375C159.32421875,1195.6770833333333,159.32421875,1204.0104166666665,159.32421875,1212.34375C159.32421875,1220.6770833333333,159.32421875,1229.0104166666665,159.32421875,1233.1770833333333L159.32421875,1237.34375" marker-end="url(#arrowhead152)" style="fill: none;"></path><defs><marker id="arrowhead152" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M159.32421875,993.59375L159.32421875,997.7604166666665C159.32421875,1001.9270833333333,159.32421875,1010.2604166666666,159.32421875,1018.5937499999999C159.32421875,1026.9270833333333,159.32421875,1035.2604166666665,159.32421875,1039.4270833333333L159.32421875,1043.59375" marker-end="url(#arrowhead153)" style="fill: none;"></path><defs><marker id="arrowhead153" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M159.32421875,913.09375L159.32421875,917.2604166666665C159.32421875,921.4270833333333,159.32421875,929.7604166666665,159.32421875,938.0937499999999C159.32421875,946.4270833333333,159.32421875,954.7604166666666,159.32421875,958.9270833333333L159.32421875,963.09375" marker-end="url(#arrowhead154)" style="fill: none;"></path><defs><marker id="arrowhead154" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M149.32421875,789.046875L149.32421874999997,797.6067708333333C149.32421875,806.1666666666666,149.32421875,823.2864583333333,150.17727910402002,836.0130208333333C151.0303394580401,848.7395833333333,152.73646016608018,857.0729166666666,153.5895205201002,861.2395833333333L154.44258087412027,865.40625" marker-end="url(#arrowhead155)" style="fill: none;"></path><defs><marker id="arrowhead155" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M149.32421875,682.1875L149.32421874999997,686.3541666666666C149.32421875,690.5208333333333,149.32421875,698.8541666666666,149.32421874999997,711.5807291666666C149.32421875,724.3072916666666,149.32421875,741.4270833333333,149.32421874999997,749.9869791666666L149.32421875,758.546875" marker-end="url(#arrowhead156)" style="fill: none;"></path><defs><marker id="arrowhead156" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M139.32421875,558.140625L139.32421875,566.7005208333334C139.32421875,575.2604166666666,139.32421875,592.3802083333333,140.17727910402004,605.1067708333333C141.0303394580401,617.8333333333333,142.73646016608018,626.1666666666666,143.58952052010022,630.3333333333334L144.44258087412027,634.5" marker-end="url(#arrowhead157)" style="fill: none;"></path><defs><marker id="arrowhead157" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M139.32421875,426.28125L139.32421875,430.44791666666663C139.32421875,434.6145833333333,139.32421875,442.94791666666663,139.32421875,451.28124999999994C139.32421875,459.61458333333326,139.32421875,467.94791666666663,139.32421875,480.67447916666663C139.32421875,493.40104166666663,139.32421875,510.52083333333326,139.32421875,519.0807291666666L139.32421875,527.640625" marker-end="url(#arrowhead158)" style="fill: none;"></path><defs><marker id="arrowhead158" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M129.32421875,277.234375L129.32421875,285.7942708333333C129.32421875,294.35416666666663,129.32421875,311.4739583333333,129.32421875,324.20052083333337C129.32421875,336.9270833333333,129.32421875,345.26041666666663,130.17727910402004,353.59374999999994C131.0303394580401,361.9270833333333,132.73646016608018,370.26041666666663,133.58952052010022,374.4270833333333L134.44258087412027,378.59375" marker-end="url(#arrowhead159)" style="fill: none;"></path><defs><marker id="arrowhead159" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M129.32421875,170.375L129.32421875,174.54166666666666C129.32421875,178.70833333333331,129.32421875,187.04166666666666,129.32421875,199.76822916666669C129.32421875,212.49479166666666,129.32421875,229.61458333333331,129.32421875,238.17447916666663L129.32421875,246.734375" marker-end="url(#arrowhead160)" style="fill: none;"></path><defs><marker id="arrowhead160" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M129.32421875,47.6875L129.32421875,51.85416666666666C129.32421875,56.02083333333333,129.32421875,64.35416666666666,129.32421875,72.6875C129.32421875,81.02083333333333,129.32421875,89.35416666666666,129.32421875,97.6875C129.32421875,106.02083333333333,129.32421875,114.35416666666666,129.32421875,118.52083333333331L129.32421875,122.6875" marker-end="url(#arrowhead161)" style="fill: none;"></path><defs><marker id="arrowhead161" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M345.42578125,284.0970110735736L321.0950520833333,291.51313422797796C296.76432291666663,298.9292573823824,248.10286458333331,313.7615036911912,223.77213541666666,325.34429351226225C199.44140625,336.9270833333333,199.44140625,345.26041666666663,194.31304732485606,353.59374999999994C189.1846883997121,361.9270833333333,178.92797054942417,370.26041666666663,173.79961162428023,374.4270833333333L168.6712526991363,378.59375" marker-end="url(#arrowhead162)" style="fill: none;"></path><defs><marker id="arrowhead162" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M417.97265625,170.375L417.97265625,174.54166666666666C417.97265625,178.70833333333331,417.97265625,187.04166666666666,417.97265625,195.375C417.97265625,203.70833333333331,417.97265625,212.04166666666666,417.97265625,216.20833333333331L417.97265625,220.375" marker-end="url(#arrowhead163)" style="fill: none;"></path><defs><marker id="arrowhead163" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M549.73828125,555.2444244848156L493.0221354166667,564.287020404013C436.3059895833333,573.3296163232103,322.87369791666663,591.4148081616052,261.0291931581894,604.6240707474692C199.1846883997121,617.8333333333333,188.92797054942417,626.1666666666666,183.79961162428023,630.3333333333334L178.6712526991363,634.5" marker-end="url(#arrowhead164)" style="fill: none;"></path><defs><marker id="arrowhead164" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M627.22265625,426.28125L627.22265625,430.44791666666663C627.22265625,434.6145833333333,627.22265625,442.94791666666663,627.22265625,451.28124999999994C627.22265625,459.61458333333326,627.22265625,467.94791666666663,627.22265625,476.28125C627.22265625,484.6145833333333,627.22265625,492.94791666666663,627.22265625,497.1145833333333L627.22265625,501.28125" marker-end="url(#arrowhead165)" style="fill: none;"></path><defs><marker id="arrowhead165" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M627.22265625,285.828125L627.22265625,292.95572916666663C627.22265625,300.0833333333333,627.22265625,314.33854166666663,627.22265625,325.6328125C627.22265625,336.9270833333333,627.22265625,345.26041666666663,627.22265625,353.59374999999994C627.22265625,361.9270833333333,627.22265625,370.26041666666663,627.22265625,374.4270833333333L627.22265625,378.59375" marker-end="url(#arrowhead166)" style="fill: none;"></path><defs><marker id="arrowhead166" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M347.06640625,797.5866864079962L325.79557291666663,804.7232803399968C304.5247395833333,811.8598742719975,261.98307291666663,826.1330621359987,235.58388065818934,837.436322734666C209.18468839971206,848.7395833333333,198.92797054942417,857.0729166666666,193.79961162428023,861.2395833333333L188.6712526991363,865.40625" marker-end="url(#arrowhead167)" style="fill: none;"></path><defs><marker id="arrowhead167" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M417.97265625,682.1875L417.97265625,686.3541666666666C417.97265625,690.5208333333333,417.97265625,698.8541666666666,417.97265625,707.1875C417.97265625,715.5208333333333,417.97265625,723.8541666666666,417.97265625,728.0208333333334L417.97265625,732.1875" marker-end="url(#arrowhead168)" style="fill: none;"></path><defs><marker id="arrowhead168" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g></g><g class="nodes"><g class="node_0 node" name="CollectLimit" transform="translate(159.32421875,1577.625)" style="opacity: 1;"><rect rx="5" ry="5" x="-38.9453125" y="-12" width="77.890625" height="24"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-33.9453125,-7)"><text><tspan space="preserve" dy="1em" x="1">CollectLimit</tspan></text></g></g></g><g class="node_2 node" name="HashAggregate\n \nnumber of output rows: 146\npeak memory total (min, med, max): \n1991.7 MB (64.2 MB, 64.2 MB, 64.2 MB)\nspill size total (min, med, max): \n0.0 B (0.0 B, 0.0 B, 0.0 B)\naggregate time total (min, med, max): \n46 ms (0 ms, 0 ms, 12 ms)" transform="translate(159.32421875,1431.25)" style="opacity: 1;"><rect rx="5" ry="5" x="-112.3828125" y="-59.375" width="224.765625" height="118.75"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-107.3828125,-54.375)"><text><tspan space="preserve" dy="1em" x="1">HashAggregate</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 146</tspan><tspan space="preserve" dy="1em" x="1">peak memory total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">1991.7 MB (64.2 MB, 64.2 MB, 64.2 MB)</tspan><tspan space="preserve" dy="1em" x="1">spill size total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">0.0 B (0.0 B, 0.0 B, 0.0 B)</tspan><tspan space="preserve" dy="1em" x="1">aggregate time total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">46 ms (0 ms, 0 ms, 12 ms)</tspan></text></g></g><g></g></g><g class="node_3 node" name="Exchange\n \ndata size total (min, med, max): \n115.5 KB (111.0 B, 671.0 B, 8.6 KB)" transform="translate(159.32421875,1267.109375)" style="opacity: 1;"><rect rx="5" ry="5" x="-99.65625" y="-29.765625" width="199.3125" height="59.53125"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-94.65625,-24.765625)"><text><tspan space="preserve" dy="1em" x="1">Exchange</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">data size total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">115.5 KB (111.0 B, 671.0 B, 8.6 KB)</tspan></text></g></g></g><g class="node_5 node" name="HashAggregate\n \nnumber of output rows: 1,090\npeak memory total (min, med, max): \n6.5 GB (256.0 KB, 64.2 MB, 64.2 MB)\nspill size total (min, med, max): \n0.0 B (0.0 B, 0.0 B, 0.0 B)\naggregate time total (min, med, max): \n5.7 m (727 ms, 1.5 s, 4.2 s)" transform="translate(159.32421875,1102.96875)" style="opacity: 1;"><rect rx="5" ry="5" x="-105.234375" y="-59.375" width="210.46875" height="118.75"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-100.234375,-54.375)"><text><tspan space="preserve" dy="1em" x="1">HashAggregate</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 1,090</tspan><tspan space="preserve" dy="1em" x="1">peak memory total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">6.5 GB (256.0 KB, 64.2 MB, 64.2 MB)</tspan><tspan space="preserve" dy="1em" x="1">spill size total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">0.0 B (0.0 B, 0.0 B, 0.0 B)</tspan><tspan space="preserve" dy="1em" x="1">aggregate time total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">5.7 m (727 ms, 1.5 s, 4.2 s)</tspan></text></g></g><g></g></g><g class="node_6 node" name="Project" transform="translate(159.32421875,978.34375)" style="opacity: 1;"><rect rx="5" ry="5" x="-25.28125" y="-12" width="50.5625" height="24"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.28125,-7)"><text><tspan space="preserve" dy="1em" x="1">Project</tspan></text></g></g><g></g></g><g class="node_7 node" name="BroadcastHashJoin\n \nnumber of output rows: 1,192" transform="translate(159.32421875,889.25)" style="opacity: 1;"><rect rx="5" ry="5" x="-83.4140625" y="-23.84375" width="166.828125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-78.4140625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastHashJoin</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 1,192</tspan></text></g></g><g></g></g><g class="node_8 node" name="Project" transform="translate(149.32421875,773.796875)" style="opacity: 1;"><rect rx="5" ry="5" x="-25.28125" y="-12" width="50.5625" height="24"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.28125,-7)"><text><tspan space="preserve" dy="1em" x="1">Project</tspan></text></g></g><g></g></g><g class="node_9 node" name="BroadcastHashJoin\n \nnumber of output rows: 1,192" transform="translate(149.32421875,658.34375)" style="opacity: 1;"><rect rx="5" ry="5" x="-83.4140625" y="-23.84375" width="166.828125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-78.4140625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastHashJoin</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 1,192</tspan></text></g></g><g></g></g><g class="node_10 node" name="Project" transform="translate(139.32421875,542.890625)" style="opacity: 1;"><rect rx="5" ry="5" x="-25.28125" y="-12" width="50.5625" height="24"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.28125,-7)"><text><tspan space="preserve" dy="1em" x="1">Project</tspan></text></g></g><g></g></g><g class="node_11 node" name="BroadcastHashJoin\n \nnumber of output rows: 2,589" transform="translate(139.32421875,402.4375)" style="opacity: 1;"><rect rx="5" ry="5" x="-83.4140625" y="-23.84375" width="166.828125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-78.4140625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastHashJoin</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 2,589</tspan></text></g></g><g></g></g><g class="node_12 node" name="Project" transform="translate(129.32421875,261.984375)" style="opacity: 1;"><rect rx="5" ry="5" x="-25.28125" y="-12" width="50.5625" height="24"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.28125,-7)"><text><tspan space="preserve" dy="1em" x="1">Project</tspan></text></g></g><g></g></g><g class="node_13 node" name="Filter\n \nnumber of output rows: 2,589" transform="translate(129.32421875,146.53125)" style="opacity: 1;" data-original-title="" title=""><rect rx="5" ry="5" x="-83.4140625" y="-23.84375" width="166.828125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-78.4140625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">Filter</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 2,589</tspan></text></g></g><g></g></g><g class="node_14 node" name="InMemoryTableScan\n \nnumber of output rows: 17,530,862" transform="translate(129.32421875,23.84375)" style="opacity: 1;"><rect rx="5" ry="5" x="-98.2265625" y="-23.84375" width="196.453125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-93.2265625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">InMemoryTableScan</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 17,530,862</tspan></text></g></g></g><g class="node_15 node" name="BroadcastExchange\n \ndata size (bytes): 389,360\ntime to collect (ms): 481\ntime to build (ms): 1\ntime to broadcast (ms): 3" transform="translate(417.97265625,261.984375)" style="opacity: 1;"><rect rx="5" ry="5" x="-72.546875" y="-41.609375" width="145.09375" height="83.21875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-67.546875,-36.609375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastExchange</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">data size (bytes): 389,360</tspan><tspan space="preserve" dy="1em" x="1">time to collect (ms): 481</tspan><tspan space="preserve" dy="1em" x="1">time to build (ms): 1</tspan><tspan space="preserve" dy="1em" x="1">time to broadcast (ms): 3</tspan></text></g></g></g><g class="node_16 node" name="HiveTableScan\n \nnumber of output rows: 5,623" transform="translate(417.97265625,146.53125)" style="opacity: 1;"><rect rx="5" ry="5" x="-83.4140625" y="-23.84375" width="166.828125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-78.4140625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">HiveTableScan</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 5,623</tspan></text></g></g></g><g class="node_17 node" name="BroadcastExchange\n \ndata size (bytes): 1,023,032\ntime to collect (ms): 474\ntime to build (ms): 12\ntime to broadcast (ms): 9" transform="translate(627.22265625,542.890625)" style="opacity: 1;"><rect rx="5" ry="5" x="-77.484375" y="-41.609375" width="154.96875" height="83.21875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-72.484375,-36.609375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastExchange</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">data size (bytes): 1,023,032</tspan><tspan space="preserve" dy="1em" x="1">time to collect (ms): 474</tspan><tspan space="preserve" dy="1em" x="1">time to build (ms): 12</tspan><tspan space="preserve" dy="1em" x="1">time to broadcast (ms): 9</tspan></text></g></g></g><g class="node_19 node" name="Filter\n \nnumber of output rows: 19,486" transform="translate(627.22265625,402.4375)" style="opacity: 1;"><rect rx="5" ry="5" x="-86.703125" y="-23.84375" width="173.40625" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-81.703125,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">Filter</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 19,486</tspan></text></g></g><g></g></g><g class="node_20 node" name="HiveTableScan\n \nnumber of output rows: 19,486" transform="translate(627.22265625,261.984375)" style="opacity: 1;"><rect rx="5" ry="5" x="-86.703125" y="-23.84375" width="173.40625" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-81.703125,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">HiveTableScan</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 19,486</tspan></text></g></g></g><g class="node_21 node" name="BroadcastExchange\n \ndata size (bytes): 16,640\ntime to collect (ms): 465\ntime to build (ms): 1\ntime to broadcast (ms): 2" transform="translate(417.97265625,773.796875)" style="opacity: 1;"><rect rx="5" ry="5" x="-70.90625" y="-41.609375" width="141.8125" height="83.21875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-65.90625,-36.609375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastExchange</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">data size (bytes): 16,640</tspan><tspan space="preserve" dy="1em" x="1">time to collect (ms): 465</tspan><tspan space="preserve" dy="1em" x="1">time to build (ms): 1</tspan><tspan space="preserve" dy="1em" x="1">time to broadcast (ms): 2</tspan></text></g></g></g><g class="node_22 node" name="HiveTableScan\n \nnumber of output rows: 1,040" transform="translate(417.97265625,658.34375)" style="opacity: 1;"><rect rx="5" ry="5" x="-83.4140625" y="-23.84375" width="166.828125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-78.4140625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">HiveTableScan</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 1,040</tspan></text></g></g></g></g></g></g></svg></div>
      <div id="plan-viz-metadata" style="display:none">
        <div class="dot-file">
          digraph G {
  0 [label="CollectLimit"];

  subgraph cluster1 {
    label="WholeStageCodegen\n\n\n48 ms (0 ms, 0 ms, 13 ms)";
      2 [label="HashAggregate\n \nnumber of output rows: 146\npeak memory total (min, med, max): \n1991.7 MB (64.2 MB, 64.2 MB, 64.2 MB)\nspill size total (min, med, max): \n0.0 B (0.0 B, 0.0 B, 0.0 B)\naggregate time total (min, med, max): \n46 ms (0 ms, 0 ms, 12 ms)"];
  }
     
  3 [label="Exchange\n \ndata size total (min, med, max): \n115.5 KB (111.0 B, 671.0 B, 8.6 KB)"];

  subgraph cluster4 {
    label="WholeStageCodegen\n\n\n5.8 m (732 ms, 1.6 s, 4.3 s)";
      5 [label="HashAggregate\n \nnumber of output rows: 1,090\npeak memory total (min, med, max): \n6.5 GB (256.0 KB, 64.2 MB, 64.2 MB)\nspill size total (min, med, max): \n0.0 B (0.0 B, 0.0 B, 0.0 B)\naggregate time total (min, med, max): \n5.7 m (727 ms, 1.5 s, 4.2 s)"];    
  6 [label="Project"];    
  7 [label="BroadcastHashJoin\n \nnumber of output rows: 1,192"];    
  8 [label="Project"];    
  9 [label="BroadcastHashJoin\n \nnumber of output rows: 1,192"];    
  10 [label="Project"];    
  11 [label="BroadcastHashJoin\n \nnumber of output rows: 2,589"];    
  12 [label="Project"];    
  13 [label="Filter\n \nnumber of output rows: 2,589"];
  }
     
  14 [label="InMemoryTableScan\n \nnumber of output rows: 17,530,862"];
  15 [label="BroadcastExchange\n \ndata size (bytes): 389,360\ntime to collect (ms): 481\ntime to build (ms): 1\ntime to broadcast (ms): 3"];
  16 [label="HiveTableScan\n \nnumber of output rows: 5,623"];
  17 [label="BroadcastExchange\n \ndata size (bytes): 1,023,032\ntime to collect (ms): 474\ntime to build (ms): 12\ntime to broadcast (ms): 9"];

  subgraph cluster18 {
    label="WholeStageCodegen\n\n\n12 ms (1 ms, 1 ms, 2 ms)";
      19 [label="Filter\n \nnumber of output rows: 19,486"];
  }
     
  20 [label="HiveTableScan\n \nnumber of output rows: 19,486"];
  21 [label="BroadcastExchange\n \ndata size (bytes): 16,640\ntime to collect (ms): 465\ntime to build (ms): 1\ntime to broadcast (ms): 2"];
  22 [label="HiveTableScan\n \nnumber of output rows: 1,040"];
  2-&gt;0;

  3-&gt;2;

  5-&gt;3;

  6-&gt;5;

  7-&gt;6;

  8-&gt;7;

  9-&gt;8;

  10-&gt;9;

  11-&gt;10;

  12-&gt;11;

  13-&gt;12;

  14-&gt;13;

  15-&gt;11;

  16-&gt;15;

  17-&gt;9;

  19-&gt;17;

  20-&gt;19;

  21-&gt;7;

  22-&gt;21;

}
        </div>
        <div id="plan-viz-metadata-size">23</div>
        <div id="plan-meta-data-0">CollectLimit 100</div><div id="plan-meta-data-2">HashAggregate(keys=[CLX_IRI_MARKET_AREA#54363, IDR_DFLT_WHSE#54349, SALES_AMT_LAST_WK#54279, SUPPLIER#54473], functions=[])</div><div id="plan-meta-data-1">WholeStageCodegen</div><div id="plan-meta-data-3">Exchange hashpartitioning(CLX_IRI_MARKET_AREA#54363, IDR_DFLT_WHSE#54349, SALES_AMT_LAST_WK#54279, SUPPLIER#54473, 200)</div><div id="plan-meta-data-5">HashAggregate(keys=[CLX_IRI_MARKET_AREA#54363, IDR_DFLT_WHSE#54349, SALES_AMT_LAST_WK#54279, SUPPLIER#54473], functions=[])</div><div id="plan-meta-data-6">Project [sales_amt_last_wk#54279, idr_dflt_whse#54349, clx_iri_market_area#54363, supplier#54473]</div><div id="plan-meta-data-7">BroadcastHashJoin [WM_WK#54225], [WM_WK#54533], LeftOuter, BuildRight</div><div id="plan-meta-data-8">Project [sales_amt_last_wk#54279, wm_wk#54225, idr_dflt_whse#54349, clx_iri_market_area#54363, supplier#54473]</div><div id="plan-meta-data-9">BroadcastHashJoin [WM_ITEM_NBR#54227], [WM_ITEM_NBR#54378], Inner, BuildRight</div><div id="plan-meta-data-10">Project [wm_item_nbr#54227, sales_amt_last_wk#54279, wm_wk#54225, idr_dflt_whse#54349, clx_iri_market_area#54363]</div><div id="plan-meta-data-11">BroadcastHashJoin [WMSTRNBR#54226], [WM_STR_NBR__STORE_CLEANED#54303], LeftOuter, BuildRight</div><div id="plan-meta-data-12">Project [wmstrnbr#54226, wm_item_nbr#54227, sales_amt_last_wk#54279, wm_wk#54225]</div><div id="plan-meta-data-13">Filter ((isnotnull(cost_amt_lyr_last_wk#54289) &amp;&amp; (cost_amt_lyr_last_wk#54289 &gt; 1000.0)) &amp;&amp; isnotnull(WM_ITEM_NBR#54227))</div><div id="plan-meta-data-4">WholeStageCodegen</div><div id="plan-meta-data-14">InMemoryTableScan [wmstrnbr#54226, wm_item_nbr#54227, sales_amt_last_wk#54279, wm_wk#54225, cost_amt_lyr_last_wk#54289], [isnotnull(cost_amt_lyr_last_wk#54289), (cost_amt_lyr_last_wk#54289 &gt; 1000.0), isnotnull(WM_ITEM_NBR#54227)]</div><div id="plan-meta-data-15">BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))</div><div id="plan-meta-data-16">HiveTableScan [wm_str_nbr__store_cleaned#54303, idr_dflt_whse#54349, clx_iri_market_area#54363], MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED</div><div id="plan-meta-data-17">BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, false]))</div><div id="plan-meta-data-19">Filter isnotnull(WM_ITEM_NBR#54378)</div><div id="plan-meta-data-18">WholeStageCodegen</div><div id="plan-meta-data-20">HiveTableScan [wm_item_nbr#54378, supplier#54473], MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN</div><div id="plan-meta-data-21">BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))</div><div id="plan-meta-data-22">HiveTableScan [wm_wk#54533], MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2</div>
      </div>
      <link rel="stylesheet" href="./query3_files/spark-sql-viz.css" type="text/css"><script src="./query3_files/d3.min.js"></script><script src="./query3_files/dagre-d3.min.js"></script><script src="./query3_files/graphlib-dot.min.js"></script><script src="./query3_files/spark-sql-viz.js"></script>
      <script>$(function() { renderPlanViz(); })</script>
    </div><div>
      <span style="cursor: pointer;" onclick="clickPhysicalPlanDetails();">
        <span id="physical-plan-details-arrow" class="arrow-closed"></span>
        <a>Details</a>
      </span>
    </div><div id="physical-plan-details" style="display: none;">
      <pre>== Parsed Logical Plan ==
'GlobalLimit 100
+- 'LocalLimit 100
   +- 'Aggregate ['STORE_FLATTENED.CLX_IRI_MARKET_AREA, 'STORE_FLATTENED.IDR_DFLT_WHSE, 'POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK, 'ITEM_FLATTEN.SUPPLIER], ['STORE_FLATTENED.CLX_IRI_MARKET_AREA AS CLX_IRI_MARKET_AREA#53864, 'STORE_FLATTENED.IDR_DFLT_WHSE AS IDR_DFLT_WHSE#53865, 'POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK AS SALES_AMT_LAST_WK#53866, 'ITEM_FLATTEN.SUPPLIER AS SUPPLIER#53867]
      +- 'Filter ('POS_INV_FACT_ROLLUP.cost_amt_lyr_last_wk &gt; 1000)
         +- 'Join LeftOuter, ('POS_INV_FACT_ROLLUP.WM_WK = 'WM_M_CAL_WEEK_2.WM_WK)
            :- 'Join Inner, ('POS_INV_FACT_ROLLUP.WM_ITEM_NBR = 'ITEM_FLATTEN.WM_ITEM_NBR)
            :  :- 'Join LeftOuter, ('POS_INV_FACT_ROLLUP.WMSTRNBR = 'STORE_FLATTENED.WM_STR_NBR__STORE_CLEANED)
            :  :  :- 'UnresolvedRelation `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`, POS_INV_FACT_ROLLUP
            :  :  +- 'UnresolvedRelation `8N_POS_INV_DASHBOARD_CUBE`.`STORE_FLATTENED`, STORE_FLATTENED
            :  +- 'UnresolvedRelation `8N_POS_INV_DASHBOARD_CUBE`.`ITEM_FLATTEN`, ITEM_FLATTEN
            +- 'UnresolvedRelation `8N_POS_INV_DASHBOARD_CUBE`.`WM_M_CAL_WEEK_2`, WM_M_CAL_WEEK_2

== Analyzed Logical Plan ==
CLX_IRI_MARKET_AREA: string, IDR_DFLT_WHSE: string, SALES_AMT_LAST_WK: double, SUPPLIER: string
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [CLX_IRI_MARKET_AREA#54363, IDR_DFLT_WHSE#54349, SALES_AMT_LAST_WK#54279, SUPPLIER#54473], [CLX_IRI_MARKET_AREA#54363 AS CLX_IRI_MARKET_AREA#53864, IDR_DFLT_WHSE#54349 AS IDR_DFLT_WHSE#53865, SALES_AMT_LAST_WK#54279 AS SALES_AMT_LAST_WK#53866, SUPPLIER#54473 AS SUPPLIER#53867]
      +- Filter (cost_amt_lyr_last_wk#54289 &gt; cast(1000 as double))
         +- Join LeftOuter, (WM_WK#54225 = WM_WK#54533)
            :- Join Inner, (WM_ITEM_NBR#54227 = WM_ITEM_NBR#54378)
            :  :- Join LeftOuter, (WMSTRNBR#54226 = WM_STR_NBR__STORE_CLEANED#54303)
            :  :  :- MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup, POS_INV_FACT_ROLLUP
            :  :  +- MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
            :  +- MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
            +- MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2

== Optimized Logical Plan ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [CLX_IRI_MARKET_AREA#54363, IDR_DFLT_WHSE#54349, SALES_AMT_LAST_WK#54279, SUPPLIER#54473], [CLX_IRI_MARKET_AREA#54363 AS CLX_IRI_MARKET_AREA#53864, IDR_DFLT_WHSE#54349 AS IDR_DFLT_WHSE#53865, SALES_AMT_LAST_WK#54279 AS SALES_AMT_LAST_WK#53866, SUPPLIER#54473 AS SUPPLIER#53867]
      +- Project [sales_amt_last_wk#54279, idr_dflt_whse#54349, clx_iri_market_area#54363, supplier#54473]
         +- Join LeftOuter, (WM_WK#54225 = WM_WK#54533)
            :- Project [sales_amt_last_wk#54279, wm_wk#54225, idr_dflt_whse#54349, clx_iri_market_area#54363, supplier#54473]
            :  +- Join Inner, (WM_ITEM_NBR#54227 = WM_ITEM_NBR#54378)
            :     :- Project [wm_item_nbr#54227, sales_amt_last_wk#54279, wm_wk#54225, idr_dflt_whse#54349, clx_iri_market_area#54363]
            :     :  +- Join LeftOuter, (WMSTRNBR#54226 = WM_STR_NBR__STORE_CLEANED#54303)
            :     :     :- Project [wmstrnbr#54226, wm_item_nbr#54227, sales_amt_last_wk#54279, wm_wk#54225]
            :     :     :  +- Filter ((isnotnull(cost_amt_lyr_last_wk#54289) &amp;&amp; (cost_amt_lyr_last_wk#54289 &gt; 1000.0)) &amp;&amp; isnotnull(WM_ITEM_NBR#54227))
            :     :     :     +- InMemoryRelation [wmstrnbr#54226, wm_item_nbr#54227, on_hand_qty#54228, on_hand_retail_amt#54229, on_order_qty#54230, in_transit_qty#54231, in_transit_retail_amt#54232, in_whse_qty#54233, in_whse_retail_amt#54234, whse_ss_order_qty#54235, wos#54236, sales_amt#54237, sales_qty#54238, cost_amt#54239, avg_amt#54240, si_mumd_qty#54241, si_mumd_amt#54242, si_mumd_percent#54243, gross_ship_qty#54244, gross_ship_cost_amt#54245, gross_ship_avg_amt#54246, traited_str_count#54247, valid_str_count#54248, pos_str_count#54249, ... 51 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`
            :     :     :        :  +- HiveTableScan [wmstrnbr#43605, wm_item_nbr#43606, on_hand_qty#43607, on_hand_retail_amt#43608, on_order_qty#43609, in_transit_qty#43610, in_transit_retail_amt#43611, in_whse_qty#43612, in_whse_retail_amt#43613, whse_ss_order_qty#43614, wos#43615, sales_amt#43616, sales_qty#43617, cost_amt#43618, avg_amt#43619, si_mumd_qty#43620, si_mumd_amt#43621, si_mumd_percent#43622, gross_ship_qty#43623, gross_ship_cost_amt#43624, gross_ship_avg_amt#43625, traited_str_count#43626, valid_str_count#43627, pos_str_count#43628, ... 51 more fields], MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup
            :     :     +- Project [wm_str_nbr__store_cleaned#54303, idr_dflt_whse#54349, clx_iri_market_area#54363]
            :     :        +- MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
            :     +- Project [wm_item_nbr#54378, supplier#54473]
            :        +- Filter isnotnull(WM_ITEM_NBR#54378)
            :           +- MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
            +- Project [wm_wk#54533]
               +- MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2

== Physical Plan ==
CollectLimit 100
+- *HashAggregate(keys=[CLX_IRI_MARKET_AREA#54363, IDR_DFLT_WHSE#54349, SALES_AMT_LAST_WK#54279, SUPPLIER#54473], functions=[], output=[CLX_IRI_MARKET_AREA#53864, IDR_DFLT_WHSE#53865, SALES_AMT_LAST_WK#53866, SUPPLIER#53867])
   +- Exchange hashpartitioning(CLX_IRI_MARKET_AREA#54363, IDR_DFLT_WHSE#54349, SALES_AMT_LAST_WK#54279, SUPPLIER#54473, 200)
      +- *HashAggregate(keys=[CLX_IRI_MARKET_AREA#54363, IDR_DFLT_WHSE#54349, SALES_AMT_LAST_WK#54279, SUPPLIER#54473], functions=[], output=[CLX_IRI_MARKET_AREA#54363, IDR_DFLT_WHSE#54349, SALES_AMT_LAST_WK#54279, SUPPLIER#54473])
         +- *Project [sales_amt_last_wk#54279, idr_dflt_whse#54349, clx_iri_market_area#54363, supplier#54473]
            +- *BroadcastHashJoin [WM_WK#54225], [WM_WK#54533], LeftOuter, BuildRight
               :- *Project [sales_amt_last_wk#54279, wm_wk#54225, idr_dflt_whse#54349, clx_iri_market_area#54363, supplier#54473]
               :  +- *BroadcastHashJoin [WM_ITEM_NBR#54227], [WM_ITEM_NBR#54378], Inner, BuildRight
               :     :- *Project [wm_item_nbr#54227, sales_amt_last_wk#54279, wm_wk#54225, idr_dflt_whse#54349, clx_iri_market_area#54363]
               :     :  +- *BroadcastHashJoin [WMSTRNBR#54226], [WM_STR_NBR__STORE_CLEANED#54303], LeftOuter, BuildRight
               :     :     :- *Project [wmstrnbr#54226, wm_item_nbr#54227, sales_amt_last_wk#54279, wm_wk#54225]
               :     :     :  +- *Filter ((isnotnull(cost_amt_lyr_last_wk#54289) &amp;&amp; (cost_amt_lyr_last_wk#54289 &gt; 1000.0)) &amp;&amp; isnotnull(WM_ITEM_NBR#54227))
               :     :     :     +- InMemoryTableScan [wmstrnbr#54226, wm_item_nbr#54227, sales_amt_last_wk#54279, wm_wk#54225, cost_amt_lyr_last_wk#54289], [isnotnull(cost_amt_lyr_last_wk#54289), (cost_amt_lyr_last_wk#54289 &gt; 1000.0), isnotnull(WM_ITEM_NBR#54227)]
               :     :     :        :  +- InMemoryRelation [wmstrnbr#54226, wm_item_nbr#54227, on_hand_qty#54228, on_hand_retail_amt#54229, on_order_qty#54230, in_transit_qty#54231, in_transit_retail_amt#54232, in_whse_qty#54233, in_whse_retail_amt#54234, whse_ss_order_qty#54235, wos#54236, sales_amt#54237, sales_qty#54238, cost_amt#54239, avg_amt#54240, si_mumd_qty#54241, si_mumd_amt#54242, si_mumd_percent#54243, gross_ship_qty#54244, gross_ship_cost_amt#54245, gross_ship_avg_amt#54246, traited_str_count#54247, valid_str_count#54248, pos_str_count#54249, ... 51 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`
               :     :     :        :     :  +- HiveTableScan [wmstrnbr#43605, wm_item_nbr#43606, on_hand_qty#43607, on_hand_retail_amt#43608, on_order_qty#43609, in_transit_qty#43610, in_transit_retail_amt#43611, in_whse_qty#43612, in_whse_retail_amt#43613, whse_ss_order_qty#43614, wos#43615, sales_amt#43616, sales_qty#43617, cost_amt#43618, avg_amt#43619, si_mumd_qty#43620, si_mumd_amt#43621, si_mumd_percent#43622, gross_ship_qty#43623, gross_ship_cost_amt#43624, gross_ship_avg_amt#43625, traited_str_count#43626, valid_str_count#43627, pos_str_count#43628, ... 51 more fields], MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup
               :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
               :     :        +- HiveTableScan [wm_str_nbr__store_cleaned#54303, idr_dflt_whse#54349, clx_iri_market_area#54363], MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
               :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, false]))
               :        +- *Filter isnotnull(WM_ITEM_NBR#54378)
               :           +- HiveTableScan [wm_item_nbr#54378, supplier#54473], MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
                  +- HiveTableScan [wm_wk#54533], MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2</pre>
    </div><script>
      function clickPhysicalPlanDetails() {
        $('#physical-plan-details').toggle();
        $('#physical-plan-details-arrow').toggleClass('arrow-open').toggleClass('arrow-closed');
      }
    </script><br>
        </div>
      
    </body></html>