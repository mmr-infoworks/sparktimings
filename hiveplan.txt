QUERY GENERATED BY TABLEAU
================================

EXPLAIN SELECT STORE_FLATTENED.CLX_IRI_MARKET_AREA AS CLX_IRI_MARKET_AREA
,STORE_FLATTENED.IDR_DFLT_WHSE AS IDR_DFLT_WHSE
,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK AS SALES_AMT_LAST_WK
,ITEM_FLATTEN.SUPPLIER AS SUPPLIER
FROM 8N_POS_INV_DASHBOARD_CUBE.POS_INV_FACT_ROLLUP POS_INV_FACT_ROLLUP LEFT OUTER JOIN
8N_POS_INV_DASHBOARD_CUBE.STORE_FLATTENED STORE_FLATTENED
ON (POS_INV_FACT_ROLLUP.WMSTRNBR = STORE_FLATTENED.WM_STR_NBR__STORE_CLEANED)
JOIN 8N_POS_INV_DASHBOARD_CUBE.ITEM_FLATTEN ITEM_FLATTEN
ON (POS_INV_FACT_ROLLUP.WM_ITEM_NBR = ITEM_FLATTEN.WM_ITEM_NBR)
LEFT JOIN 8N_POS_INV_DASHBOARD_CUBE.WM_M_CAL_WEEK_2 WM_M_CAL_WEEK_2
--NOTE THE FILTER IS ON DIMENSION TABLE BELOW
ON (POS_INV_FACT_ROLLUP.WM_WK = WM_M_CAL_WEEK_2.WM_WK) WHERE WM_M_CAL_WEEK_2.WM_WK = 201634 
 GROUP BY STORE_FLATTENED.CLX_IRI_MARKET_AREA
,STORE_FLATTENED.IDR_DFLT_WHSE
,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK
,ITEM_FLATTEN.SUPPLIER ;
 Plan not optimized by CBO due to missing statistics. Please check log for more details.                                                                                                                                     |
|                                                                                                                                                                                                                             |
| Vertex dependency in root stage                                                                                                                                                                                             |
| Map 1 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)                                                                                                                                             |
| Reducer 2 <- Map 1 (SIMPLE_EDGE)                                                                                                                                                                                            |
|                                                                                                                                                                                                                             |
| Stage-0                                                                                                                                                                                                                     |
|    Fetch Operator                                                                                                                                                                                                           |
|       limit:-1                                                                                                                                                                                                              |
|       Stage-1                                                                                                                                                                                                               |
|          Reducer 2 vectorized                                                                                                                                                                                               |
|          File Output Operator [FS_2169]                                                                                                                                                                                     |
|             compressed:false                                                                                                                                                                                                |
|             Statistics:Num rows: 94254099 Data size: 10179442733 Basic stats: COMPLETE Column stats: NONE                                                                                                                   |
|             table:{"input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"}  |
|             Group By Operator [OP_2168]                                                                                                                                                                                     |
|             |  keys:KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: double), KEY._col3 (type: string)                                                                                                  |
|             |  outputColumnNames:["_col0","_col1","_col2","_col3"]                                                                                                                                                          |
|             |  Statistics:Num rows: 94254099 Data size: 10179442733 Basic stats: COMPLETE Column stats: NONE                                                                                                                |
|             |<-Map 1 [SIMPLE_EDGE] vectorized                                                                                                                                                                               |
|                Reduce Output Operator [RS_2137]                                                                                                                                                                             |
|                   key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: double), _col3 (type: string)                                                                                                    |
|                   Map-reduce partition columns:_col0 (type: string), _col1 (type: string), _col2 (type: double), _col3 (type: string)                                                                                       |
|                   sort order:++++                                                                                                                                                                                           |
|                   Statistics:Num rows: 188508198 Data size: 20358885467 Basic stats: COMPLETE Column stats: NONE                                                                                                            |
|                   Group By Operator [OP_2167]                                                                                                                                                                               |
|                      keys:_col141 (type: string), _col127 (type: string), _col53 (type: double), _col254 (type: string)                                                                                                     |
|                      outputColumnNames:["_col0","_col1","_col2","_col3"]                                                                                                                                                    |
|                      Statistics:Num rows: 188508198 Data size: 20358885467 Basic stats: COMPLETE Column stats: NONE                                                                                                         |
|                      Select Operator [OP_2166]                                                                                                                                                                              |
|                         outputColumnNames:["_col141","_col127","_col53","_col254"]                                                                                                                                          |
|                         Statistics:Num rows: 188508198 Data size: 20358885467 Basic stats: COMPLETE Column stats: NONE                                                                                                      |
|                         Filter Operator [FIL_2165]                                                                                                                                                                          |
|                            predicate:(_col317 = 201634) (type: boolean)                                                                                                                                                     |
|                            Statistics:Num rows: 188508198 Data size: 20358885467 Basic stats: COMPLETE Column stats: NONE                                                                                                   |
|                            Map Join Operator [MAPJOIN_2164]                                                                                                                                                                 |
|                            |  condition map:[{"":"Left Outer Join0 to 1"}]                                                                                                                                                  |
|                            |  HybridGraceHashJoin:true                                                                                                                                                                      |
|                            |  keys:{"Map 1":"_col74 (type: int)","Map 5":"wm_wk (type: int)"}                                                                                                                               |
|                            |  outputColumnNames:["_col53","_col127","_col141","_col254","_col317"]                                                                                                                          |
|                            |  Statistics:Num rows: 377016397 Data size: 40717771042 Basic stats: COMPLETE Column stats: NONE                                                                                                |
|                            |<-Map 5 [BROADCAST_EDGE] vectorized                                                                                                                                                             |
|                            |  Reduce Output Operator [RS_2160]                                                                                                                                                              |
|                            |     key expressions:wm_wk (type: int)                                                                                                                                                          |
|                            |     Map-reduce partition columns:wm_wk (type: int)                                                                                                                                             |
|                            |     sort order:+                                                                                                                                                                               |
|                            |     Statistics:Num rows: 1040 Data size: 1483040 Basic stats: COMPLETE Column stats: NONE                                                                                                      |
|                            |     TableScan [TS_2122]                                                                                                                                                                        |
|                            |        alias:wm_m_cal_week_2                                                                                                                                                                   |
|                            |        Statistics:Num rows: 1040 Data size: 1483040 Basic stats: COMPLETE Column stats: NONE                                                                                                   |
|                            |<-Map Join Operator [MAPJOIN_2163]                                                                                                                                                              |
|                               |  condition map:[{"":"Inner Join 0 to 1"}]                                                                                                                                                   |
|                               |  HybridGraceHashJoin:true                                                                                                                                                                   |
|                               |  keys:{"Map 1":"_col1 (type: string)","Map 4":"wm_item_nbr (type: string)"}                                                                                                                 |
|                               |  outputColumnNames:["_col53","_col74","_col127","_col141","_col254"]                                                                                                                        |
|                               |  Statistics:Num rows: 342742172 Data size: 37016154691 Basic stats: COMPLETE Column stats: NONE                                                                                             |
|                               |<-Map 4 [BROADCAST_EDGE] vectorized                                                                                                                                                          |
|                               |  Reduce Output Operator [RS_2159]                                                                                                                                                           |
|                               |     key expressions:wm_item_nbr (type: string)                                                                                                                                              |
|                               |     Map-reduce partition columns:wm_item_nbr (type: string)                                                                                                                                 |
|                               |     sort order:+                                                                                                                                                                            |
|                               |     Statistics:Num rows: 9743 Data size: 113431200 Basic stats: COMPLETE Column stats: NONE                                                                                                 |
|                               |     value expressions:supplier (type: string)                                                                                                                                               |
|                               |     Filter Operator [FIL_2158]                                                                                                                                                              |
|                               |        predicate:wm_item_nbr is not null (type: boolean)                                                                                                                                    |
|                               |        Statistics:Num rows: 9743 Data size: 113431200 Basic stats: COMPLETE Column stats: NONE                                                                                              |
|                               |        TableScan [TS_2121]                                                                                                                                                                  |
|                               |           alias:item_flatten                                                                                                                                                                |
|                               |           Statistics:Num rows: 19486 Data size: 226862401 Basic stats: COMPLETE Column stats: NONE                                                                                          |
|                               |<-Map Join Operator [MAPJOIN_2162]                                                                                                                                                           |
|                                  |  condition map:[{"":"Left Outer Join0 to 1"}]                                                                                                                                            |
|                                  |  HybridGraceHashJoin:true                                                                                                                                                                |
|                                  |  keys:{"Map 3":"wm_str_nbr__store_cleaned (type: int)","Map 1":"wmstrnbr (type: int)"}                                                                                                   |
|                                  |  outputColumnNames:["_col1","_col53","_col74","_col127","_col141"]                                                                                                                       |
|                                  |  Statistics:Num rows: 311583786 Data size: 33651048990 Basic stats: COMPLETE Column stats: NONE                                                                                          |
|                                  |<-Map 3 [BROADCAST_EDGE] vectorized                                                                                                                                                       |
|                                  |  Reduce Output Operator [RS_2157]                                                                                                                                                        |
|                                  |     key expressions:wm_str_nbr__store_cleaned (type: int)                                                                                                                                |
|                                  |     Map-reduce partition columns:wm_str_nbr__store_cleaned (type: int)                                                                                                                   |
|                                  |     sort order:+                                                                                                                                                                         |
|                                  |     Statistics:Num rows: 5623 Data size: 32683918 Basic stats: COMPLETE Column stats: NONE                                                                                               |
|                                  |     value expressions:idr_dflt_whse (type: string), clx_iri_market_area (type: string)                                                                                                   |
|                                  |     TableScan [TS_2120]                                                                                                                                                                  |
|                                  |        alias:store_flattened                                                                                                                                                             |
|                                  |        Statistics:Num rows: 5623 Data size: 32683918 Basic stats: COMPLETE Column stats: NONE                                                                                            |
|                                  |<-Filter Operator [FIL_2161]                                                                                                                                                              |
|                                        predicate:wm_item_nbr is not null (type: boolean)                                                                                                                                    |
|                                        Statistics:Num rows: 283257982 Data size: 30591862056 Basic stats: COMPLETE Column stats: COMPLETE                                                                                   |
|                                        TableScan [TS_2119]                                                                                                                                                                  |
|                                           alias:pos_inv_fact_rollup                                                                                                                                                         |
|                                           Statistics:Num rows: 283257982 Data size: 178863439624 Basic stats: COMPLETE Column stats: COMPLETE                                                                               |
|                                                                                                                                                                                                                             |
NOTE ABOVE that it scans the pos_inv_fact_rollup for all rows 283257982


QUERY OPTIMIZED 
EXPLAIN SELECT STORE_FLATTENED.CLX_IRI_MARKET_AREA AS CLX_IRI_MARKET_AREA
,STORE_FLATTENED.IDR_DFLT_WHSE AS IDR_DFLT_WHSE
,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK AS SALES_AMT_LAST_WK
,ITEM_FLATTEN.SUPPLIER AS SUPPLIER
FROM 8N_POS_INV_DASHBOARD_CUBE.POS_INV_FACT_ROLLUP POS_INV_FACT_ROLLUP LEFT OUTER JOIN
8N_POS_INV_DASHBOARD_CUBE.STORE_FLATTENED STORE_FLATTENED
ON (POS_INV_FACT_ROLLUP.WMSTRNBR = STORE_FLATTENED.WM_STR_NBR__STORE_CLEANED)
JOIN 8N_POS_INV_DASHBOARD_CUBE.ITEM_FLATTEN ITEM_FLATTEN
ON (POS_INV_FACT_ROLLUP.WM_ITEM_NBR = ITEM_FLATTEN.WM_ITEM_NBR)
LEFT JOIN 8N_POS_INV_DASHBOARD_CUBE.WM_M_CAL_WEEK_2 WM_M_CAL_WEEK_2
--NOTE THE FILTER IS ON FACT TABLE BELOW
ON (POS_INV_FACT_ROLLUP.WM_WK = WM_M_CAL_WEEK_2.WM_WK) WHERE POS_INV_FACT_ROLLUP.WM_WK = 201634 
 GROUP BY STORE_FLATTENED.CLX_IRI_MARKET_AREA
,STORE_FLATTENED.IDR_DFLT_WHSE
,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK
,ITEM_FLATTEN.SUPPLIER ;


+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
|                                                                                                           Explain                                                                                                           |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
| Plan not optimized by CBO due to missing statistics. Please check log for more details.                                                                                                                                     |
|                                                                                                                                                                                                                             |
| Vertex dependency in root stage                                                                                                                                                                                             |
| Map 1 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)                                                                                                                                             |
| Reducer 2 <- Map 1 (SIMPLE_EDGE)                                                                                                                                                                                            |
|                                                                                                                                                                                                                             |
| Stage-0                                                                                                                                                                                                                     |
|    Fetch Operator                                                                                                                                                                                                           |
|       limit:-1                                                                                                                                                                                                              |
|       Stage-1                                                                                                                                                                                                               |
|          Reducer 2 vectorized                                                                                                                                                                                               |
|          File Output Operator [FS_2272]                                                                                                                                                                                     |
|             compressed:false                                                                                                                                                                                                |
|             Statistics:Num rows: 919780 Data size: 99336342 Basic stats: COMPLETE Column stats: NONE                                                                                                                        |
|             table:{"input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"}  |
|             Group By Operator [OP_2271]                                                                                                                                                                                     |
|             |  keys:KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: double), KEY._col3 (type: string)                                                                                                  |
|             |  outputColumnNames:["_col0","_col1","_col2","_col3"]                                                                                                                                                          |
|             |  Statistics:Num rows: 919780 Data size: 99336342 Basic stats: COMPLETE Column stats: NONE                                                                                                                     |
|             |<-Map 1 [SIMPLE_EDGE] vectorized                                                                                                                                                                               |
|                Reduce Output Operator [RS_2241]                                                                                                                                                                             |
|                   key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: double), _col3 (type: string)                                                                                                    |
|                   Map-reduce partition columns:_col0 (type: string), _col1 (type: string), _col2 (type: double), _col3 (type: string)                                                                                       |
|                   sort order:++++                                                                                                                                                                                           |
|                   Statistics:Num rows: 1839560 Data size: 198672685 Basic stats: COMPLETE Column stats: NONE                                                                                                                |
|                   Group By Operator [OP_2270]                                                                                                                                                                               |
|                      keys:_col141 (type: string), _col127 (type: string), _col53 (type: double), _col254 (type: string)                                                                                                     |
|                      outputColumnNames:["_col0","_col1","_col2","_col3"]                                                                                                                                                    |
|                      Statistics:Num rows: 1839560 Data size: 198672685 Basic stats: COMPLETE Column stats: NONE                                                                                                             |
|                      Select Operator [OP_2269]                                                                                                                                                                              |
|                         outputColumnNames:["_col141","_col127","_col53","_col254"]                                                                                                                                          |
|                         Statistics:Num rows: 1839560 Data size: 198672685 Basic stats: COMPLETE Column stats: NONE                                                                                                          |
|                         Map Join Operator [MAPJOIN_2268]                                                                                                                                                                    |
|                         |  condition map:[{"":"Left Outer Join0 to 1"}]                                                                                                                                                     |
|                         |  HybridGraceHashJoin:true                                                                                                                                                                         |
|                         |  keys:{"Map 1":"_col74 (type: int)","Map 5":"wm_wk (type: int)"}                                                                                                                                  |
|                         |  outputColumnNames:["_col53","_col127","_col141","_col254"]                                                                                                                                       |
|                         |  Statistics:Num rows: 1839560 Data size: 198672685 Basic stats: COMPLETE Column stats: NONE                                                                                                       |
|                         |<-Map 5 [BROADCAST_EDGE] vectorized                                                                                                                                                                |
|                         |  Reduce Output Operator [RS_2264]                                                                                                                                                                 |
|                         |     key expressions:wm_wk (type: int)                                                                                                                                                             |
|                         |     Map-reduce partition columns:wm_wk (type: int)                                                                                                                                                |
|                         |     sort order:+                                                                                                                                                                                  |
|                         |     Statistics:Num rows: 520 Data size: 741520 Basic stats: COMPLETE Column stats: NONE                                                                                                           |
|                         |     Filter Operator [FIL_2263]                                                                                                                                                                    |
|                         |        predicate:(wm_wk = 201634) (type: boolean)                                                                                                                                                 |
|                         |        Statistics:Num rows: 520 Data size: 741520 Basic stats: COMPLETE Column stats: NONE                                                                                                        |
|                         |        TableScan [TS_2226]                                                                                                                                                                        |
|                         |           alias:wm_m_cal_week_2                                                                                                                                                                   |
|                         |           Statistics:Num rows: 1040 Data size: 1483040 Basic stats: COMPLETE Column stats: NONE                                                                                                   |
|                         |<-Map Join Operator [MAPJOIN_2267]                                                                                                                                                                 |
|                            |  condition map:[{"":"Inner Join 0 to 1"}]                                                                                                                                                      |
|                            |  HybridGraceHashJoin:true                                                                                                                                                                      |
|                            |  keys:{"Map 1":"_col1 (type: string)","Map 4":"wm_item_nbr (type: string)"}                                                                                                                    |
|                            |  outputColumnNames:["_col53","_col74","_col127","_col141","_col254"]                                                                                                                           |
|                            |  Statistics:Num rows: 1672328 Data size: 180611528 Basic stats: COMPLETE Column stats: NONE                                                                                                    |
|                            |<-Map 4 [BROADCAST_EDGE] vectorized                                                                                                                                                             |
|                            |  Reduce Output Operator [RS_2262]                                                                                                                                                              |
|                            |     key expressions:wm_item_nbr (type: string)                                                                                                                                                 |
|                            |     Map-reduce partition columns:wm_item_nbr (type: string)                                                                                                                                    |
|                            |     sort order:+                                                                                                                                                                               |
|                            |     Statistics:Num rows: 9743 Data size: 113431200 Basic stats: COMPLETE Column stats: NONE                                                                                                    |
|                            |     value expressions:supplier (type: string)                                                                                                                                                  |
|                            |     Filter Operator [FIL_2261]                                                                                                                                                                 |
|                            |        predicate:wm_item_nbr is not null (type: boolean)                                                                                                                                       |
|                            |        Statistics:Num rows: 9743 Data size: 113431200 Basic stats: COMPLETE Column stats: NONE                                                                                                 |
|                            |        TableScan [TS_2225]                                                                                                                                                                     |
|                            |           alias:item_flatten                                                                                                                                                                   |
|                            |           Statistics:Num rows: 19486 Data size: 226862401 Basic stats: COMPLETE Column stats: NONE                                                                                             |
|                            |<-Map Join Operator [MAPJOIN_2266]                                                                                                                                                              |
|                               |  condition map:[{"":"Left Outer Join0 to 1"}]                                                                                                                                               |
|                               |  HybridGraceHashJoin:true                                                                                                                                                                   |
|                               |  keys:{"Map 3":"wm_str_nbr__store_cleaned (type: int)","Map 1":"wmstrnbr (type: int)"}                                                                                                      |
|                               |  outputColumnNames:["_col1","_col53","_col74","_col127","_col141"]                                                                                                                          |
|                               |  Statistics:Num rows: 1520299 Data size: 164192295 Basic stats: COMPLETE Column stats: NONE                                                                                                 |
|                               |<-Map 3 [BROADCAST_EDGE] vectorized                                                                                                                                                          |
|                               |  Reduce Output Operator [RS_2260]                                                                                                                                                           |
|                               |     key expressions:wm_str_nbr__store_cleaned (type: int)                                                                                                                                   |
|                               |     Map-reduce partition columns:wm_str_nbr__store_cleaned (type: int)                                                                                                                      |
|                               |     sort order:+                                                                                                                                                                            |
|                               |     Statistics:Num rows: 5623 Data size: 32683918 Basic stats: COMPLETE Column stats: NONE                                                                                                  |
|                               |     value expressions:idr_dflt_whse (type: string), clx_iri_market_area (type: string)                                                                                                      |
|                               |     TableScan [TS_2224]                                                                                                                                                                     |
|                               |        alias:store_flattened                                                                                                                                                                |
|                               |        Statistics:Num rows: 5623 Data size: 32683918 Basic stats: COMPLETE Column stats: NONE                                                                                               |
|                               |<-Filter Operator [FIL_2265]                                                                                                                                                                 |
|                                     predicate:wm_item_nbr is not null (type: boolean)                                                                                                                                       |
|                                     Statistics:Num rows: 1382090 Data size: 149265720 Basic stats: COMPLETE Column stats: COMPLETE                                                                                          |
|                                     TableScan [TS_2223]                                                                                                                                                                     |
|                                        alias:pos_inv_fact_rollup                                                                                                                                                            |
|                                        Statistics:Num rows: 1382090 Data size: 890539080 Basic stats: COMPLETE Column stats: COMPLETE                                                                                       |
|                                                                                                                                                                                                                             |
NOTE ABOVE THAT ITS SCANNING ONLY 1382090 rows from pos_inv_fact_rollup



: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> EXPLAIN SELECT STORE_FLATTENED.CLX_IRI_MARKET_AREA AS CLX_IRI_MARKET_AREA
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ,STORE_FLATTENED.IDR_DFLT_WHSE AS IDR_DFLT_WHSE
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK AS SALES_AMT_LAST_WK
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ,ITEM_FLATTEN.SUPPLIER AS SUPPLIER
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> FROM 8N_POS_INV_DASHBOARD_CUBE.POS_INV_FACT_ROLLUP POS_INV_FACT_ROLLUP
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> LEFT OUTER JOIN 8N_POS_INV_DASHBOARD_CUBE.STORE_FLATTENED STORE_FLATTENED
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ON (POS_INV_FACT_ROLLUP.WMSTRNBR = STORE_FLATTENED.WM_STR_NBR__STORE_CLEANED)
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j>  JOIN 8N_POS_INV_DASHBOARD_CUBE.ITEM_FLATTEN ITEM_FLATTEN
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j>   ON (POS_INV_FACT_ROLLUP.WM_ITEM_NBR = ITEM_FLATTEN.WM_ITEM_NBR)
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j>   LEFT JOIN 8N_POS_INV_DASHBOARD_CUBE.WM_M_CAL_WEEK_2 WM_M_CAL_WEEK_2
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j>   ON (POS_INV_FACT_ROLLUP.WM_WK = WM_M_CAL_WEEK_2.WM_WK)
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j>   WHERE POS_INV_FACT_ROLLUP.cost_amt_lyr_last_wk > 1000
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j>   GROUP BY STORE_FLATTENED.CLX_IRI_MARKET_AREA
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ,STORE_FLATTENED.IDR_DFLT_WHSE
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ,ITEM_FLATTEN.SUPPLIER LIMIT 100;
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
|                                                                                                           Explain                                                                                                           |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
| Plan not optimized by CBO due to missing statistics. Please check log for more details.                                                                                                                                     |
|                                                                                                                                                                                                                             |
| Vertex dependency in root stage                                                                                                                                                                                             |
| Map 1 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)                                                                                                                                             |
| Reducer 2 <- Map 1 (SIMPLE_EDGE)                                                                                                                                                                                            |
|                                                                                                                                                                                                                             |
| Stage-0                                                                                                                                                                                                                     |
|    Fetch Operator                                                                                                                                                                                                           |
|       limit:100                                                                                                                                                                                                             |
|       Stage-1                                                                                                                                                                                                               |
|          Reducer 2 vectorized                                                                                                                                                                                               |
|          File Output Operator [FS_2325]                                                                                                                                                                                     |
|             compressed:false                                                                                                                                                                                                |
|             Statistics:Num rows: 100 Data size: 11600 Basic stats: COMPLETE Column stats: NONE                                                                                                                              |
|             table:{"input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"}  |
|             Limit [LIM_2324]                                                                                                                                                                                                |
|                Number of rows:100                                                                                                                                                                                           |
|                Statistics:Num rows: 100 Data size: 11600 Basic stats: COMPLETE Column stats: NONE                                                                                                                           |
|                Group By Operator [OP_2323]                                                                                                                                                                                  |
|                |  keys:KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: double), KEY._col3 (type: string)                                                                                               |
|                |  outputColumnNames:["_col0","_col1","_col2","_col3"]                                                                                                                                                       |
|                |  Statistics:Num rows: 62836065 Data size: 7288983679 Basic stats: COMPLETE Column stats: NONE                                                                                                              |
|                |<-Map 1 [SIMPLE_EDGE] vectorized                                                                                                                                                                            |
|                   Reduce Output Operator [RS_2293]                                                                                                                                                                          |
|                      key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: double), _col3 (type: string)                                                                                                 |
|                      Map-reduce partition columns:_col0 (type: string), _col1 (type: string), _col2 (type: double), _col3 (type: string)                                                                                    |
|                      sort order:++++                                                                                                                                                                                        |
|                      Statistics:Num rows: 125672130 Data size: 14577967358 Basic stats: COMPLETE Column stats: NONE                                                                                                         |
|                      Group By Operator [OP_2322]                                                                                                                                                                            |
|                         keys:_col141 (type: string), _col127 (type: string), _col53 (type: double), _col254 (type: string)                                                                                                  |
|                         outputColumnNames:["_col0","_col1","_col2","_col3"]                                                                                                                                                 |
|                         Statistics:Num rows: 125672130 Data size: 14577967358 Basic stats: COMPLETE Column stats: NONE                                                                                                      |
|                         Select Operator [OP_2321]                                                                                                                                                                           |
|                            outputColumnNames:["_col141","_col127","_col53","_col254"]                                                                                                                                       |
|                            Statistics:Num rows: 125672130 Data size: 14577967358 Basic stats: COMPLETE Column stats: NONE                                                                                                   |
|                            Map Join Operator [MAPJOIN_2320]                                                                                                                                                                 |
|                            |  condition map:[{"":"Left Outer Join0 to 1"}]                                                                                                                                                  |
|                            |  HybridGraceHashJoin:true                                                                                                                                                                      |
|                            |  keys:{"Map 1":"_col74 (type: int)","Map 5":"wm_wk (type: int)"}                                                                                                                               |
|                            |  outputColumnNames:["_col53","_col127","_col141","_col254"]                                                                                                                                    |
|                            |  Statistics:Num rows: 125672130 Data size: 14577967358 Basic stats: COMPLETE Column stats: NONE                                                                                                |
|                            |<-Map 5 [BROADCAST_EDGE] vectorized                                                                                                                                                             |
|                            |  Reduce Output Operator [RS_2316]                                                                                                                                                              |
|                            |     key expressions:wm_wk (type: int)                                                                                                                                                          |
|                            |     Map-reduce partition columns:wm_wk (type: int)                                                                                                                                             |
|                            |     sort order:+                                                                                                                                                                               |
|                            |     Statistics:Num rows: 1040 Data size: 1483040 Basic stats: COMPLETE Column stats: NONE                                                                                                      |
|                            |     TableScan [TS_2278]                                                                                                                                                                        |
|                            |        alias:wm_m_cal_week_2                                                                                                                                                                   |
|                            |        Statistics:Num rows: 1040 Data size: 1483040 Basic stats: COMPLETE Column stats: NONE                                                                                                   |
|                            |<-Map Join Operator [MAPJOIN_2319]                                                                                                                                                              |
|                               |  condition map:[{"":"Inner Join 0 to 1"}]                                                                                                                                                   |
|                               |  HybridGraceHashJoin:true                                                                                                                                                                   |
|                               |  keys:{"Map 1":"_col1 (type: string)","Map 4":"wm_item_nbr (type: string)"}                                                                                                                 |
|                               |  outputColumnNames:["_col53","_col74","_col127","_col141","_col254"]                                                                                                                        |
|                               |  Statistics:Num rows: 114247389 Data size: 13252697311 Basic stats: COMPLETE Column stats: NONE                                                                                             |
|                               |<-Map 4 [BROADCAST_EDGE] vectorized                                                                                                                                                          |
|                               |  Reduce Output Operator [RS_2315]                                                                                                                                                           |
|                               |     key expressions:wm_item_nbr (type: string)                                                                                                                                              |
|                               |     Map-reduce partition columns:wm_item_nbr (type: string)                                                                                                                                 |
|                               |     sort order:+                                                                                                                                                                            |
|                               |     Statistics:Num rows: 9743 Data size: 113431200 Basic stats: COMPLETE Column stats: NONE                                                                                                 |
|                               |     value expressions:supplier (type: string)                                                                                                                                               |
|                               |     Filter Operator [FIL_2314]                                                                                                                                                              |
|                               |        predicate:wm_item_nbr is not null (type: boolean)                                                                                                                                    |
|                               |        Statistics:Num rows: 9743 Data size: 113431200 Basic stats: COMPLETE Column stats: NONE                                                                                              |
|                               |        TableScan [TS_2277]                                                                                                                                                                  |
|                               |           alias:item_flatten                                                                                                                                                                |
|                               |           Statistics:Num rows: 19486 Data size: 226862401 Basic stats: COMPLETE Column stats: NONE                                                                                          |
|                               |<-Map Join Operator [MAPJOIN_2318]                                                                                                                                                           |
|                                  |  condition map:[{"":"Left Outer Join0 to 1"}]                                                                                                                                            |
|                                  |  HybridGraceHashJoin:true                                                                                                                                                                |
|                                  |  keys:{"Map 3":"wm_str_nbr__store_cleaned (type: int)","Map 1":"wmstrnbr (type: int)"}                                                                                                   |
|                                  |  outputColumnNames:["_col1","_col53","_col74","_col127","_col141"]                                                                                                                       |
|                                  |  Statistics:Num rows: 103861261 Data size: 12047906386 Basic stats: COMPLETE Column stats: NONE                                                                                          |
|                                  |<-Map 3 [BROADCAST_EDGE] vectorized                                                                                                                                                       |
|                                  |  Reduce Output Operator [RS_2313]                                                                                                                                                        |
|                                  |     key expressions:wm_str_nbr__store_cleaned (type: int)                                                                                                                                |
|                                  |     Map-reduce partition columns:wm_str_nbr__store_cleaned (type: int)                                                                                                                   |
|                                  |     sort order:+                                                                                                                                                                         |
|                                  |     Statistics:Num rows: 5623 Data size: 32683918 Basic stats: COMPLETE Column stats: NONE                                                                                               |
|                                  |     value expressions:idr_dflt_whse (type: string), clx_iri_market_area (type: string)                                                                                                   |
|                                  |     TableScan [TS_2276]                                                                                                                                                                  |
|                                  |        alias:store_flattened                                                                                                                                                             |
|                                  |        Statistics:Num rows: 5623 Data size: 32683918 Basic stats: COMPLETE Column stats: NONE                                                                                            |
|                                  |<-Filter Operator [FIL_2317]                                                                                                                                                              |
|                                        predicate:(wm_item_nbr is not null and (cost_amt_lyr_last_wk > 1000.0)) (type: boolean)                                                                                              |
|                                        Statistics:Num rows: 94419327 Data size: 10952641932 Basic stats: COMPLETE Column stats: COMPLETE                                                                                    |
|                                        TableScan [TS_2275]                                                                                                                                                                  |
|                                           alias:pos_inv_fact_rollup                                                                                                                                                         |
|                                           Statistics:Num rows: 283257982 Data size: 178863439624 Basic stats: COMPLETE Column stats: COMPLETE                                                                               |
|                                                                                                                                                                                                                             |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
92 rows selected (6.999 seconds)
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20


rows selected (6.999 seconds)
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> EXPLAIN SELECT STORE_FLATTENED.CLX_IRI_MARKET_AREA AS CLX_IRI_MARKET_AREA
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ,STORE_FLATTENED.IDR_DFLT_WHSE AS IDR_DFLT_WHSE
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK AS SALES_AMT_LAST_WK
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ,ITEM_FLATTEN.SUPPLIER AS SUPPLIER
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> FROM 8N_POS_INV_DASHBOARD_CUBE.POS_INV_FACT_ROLLUP POS_INV_FACT_ROLLUP
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> LEFT OUTER JOIN 8N_POS_INV_DASHBOARD_CUBE.STORE_FLATTENED STORE_FLATTENED
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ON (POS_INV_FACT_ROLLUP.WMSTRNBR = STORE_FLATTENED.WM_STR_NBR__STORE_CLEANED)
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j>  JOIN 8N_POS_INV_DASHBOARD_CUBE.ITEM_FLATTEN ITEM_FLATTEN
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j>   ON (POS_INV_FACT_ROLLUP.WM_ITEM_NBR = ITEM_FLATTEN.WM_ITEM_NBR)
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j>   LEFT JOIN 8N_POS_INV_DASHBOARD_CUBE.WM_M_CAL_WEEK_2 WM_M_CAL_WEEK_2
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j>   ON (POS_INV_FACT_ROLLUP.WM_WK = WM_M_CAL_WEEK_2.WM_WK)
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j>   WHERE POS_INV_FACT_ROLLUP.sales_amt_last_wk > 10
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j>   GROUP BY STORE_FLATTENED.CLX_IRI_MARKET_AREA
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ,STORE_FLATTENED.IDR_DFLT_WHSE
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ,POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK
0: jdbc:hive2://hn0-infowo.jcv2muboubcedio20j> ,ITEM_FLATTEN.SUPPLIER LIMIT 100;
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
|                                                                                                           Explain                                                                                                           |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
| Plan not optimized by CBO due to missing statistics. Please check log for more details.                                                                                                                                     |
|                                                                                                                                                                                                                             |
| Vertex dependency in root stage                                                                                                                                                                                             |
| Map 1 <- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)                                                                                                                                             |
| Reducer 2 <- Map 1 (SIMPLE_EDGE)                                                                                                                                                                                            |
|                                                                                                                                                                                                                             |
| Stage-0                                                                                                                                                                                                                     |
|    Fetch Operator                                                                                                                                                                                                           |
|       limit:100                                                                                                                                                                                                             |
|       Stage-1                                                                                                                                                                                                               |
|          Reducer 2 vectorized                                                                                                                                                                                               |
|          File Output Operator [FS_2377]                                                                                                                                                                                     |
|             compressed:false                                                                                                                                                                                                |
|             Statistics:Num rows: 100 Data size: 10800 Basic stats: COMPLETE Column stats: NONE                                                                                                                              |
|             table:{"input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"}  |
|             Limit [LIM_2376]                                                                                                                                                                                                |
|                Number of rows:100                                                                                                                                                                                           |
|                Statistics:Num rows: 100 Data size: 10800 Basic stats: COMPLETE Column stats: NONE                                                                                                                           |
|                Group By Operator [OP_2375]                                                                                                                                                                                  |
|                |  keys:KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: double), KEY._col3 (type: string)                                                                                               |
|                |  outputColumnNames:["_col0","_col1","_col2","_col3"]                                                                                                                                                       |
|                |  Statistics:Num rows: 62836065 Data size: 6786295149 Basic stats: COMPLETE Column stats: NONE                                                                                                              |
|                |<-Map 1 [SIMPLE_EDGE] vectorized                                                                                                                                                                            |
|                   Reduce Output Operator [RS_2345]                                                                                                                                                                          |
|                      key expressions:_col0 (type: string), _col1 (type: string), _col2 (type: double), _col3 (type: string)                                                                                                 |
|                      Map-reduce partition columns:_col0 (type: string), _col1 (type: string), _col2 (type: double), _col3 (type: string)                                                                                    |
|                      sort order:++++                                                                                                                                                                                        |
|                      Statistics:Num rows: 125672130 Data size: 13572590298 Basic stats: COMPLETE Column stats: NONE                                                                                                         |
|                      Group By Operator [OP_2374]                                                                                                                                                                            |
|                         keys:_col141 (type: string), _col127 (type: string), _col53 (type: double), _col254 (type: string)                                                                                                  |
|                         outputColumnNames:["_col0","_col1","_col2","_col3"]                                                                                                                                                 |
|                         Statistics:Num rows: 125672130 Data size: 13572590298 Basic stats: COMPLETE Column stats: NONE                                                                                                      |
|                         Select Operator [OP_2373]                                                                                                                                                                           |
|                            outputColumnNames:["_col141","_col127","_col53","_col254"]                                                                                                                                       |
|                            Statistics:Num rows: 125672130 Data size: 13572590298 Basic stats: COMPLETE Column stats: NONE                                                                                                   |
|                            Map Join Operator [MAPJOIN_2372]                                                                                                                                                                 |
|                            |  condition map:[{"":"Left Outer Join0 to 1"}]                                                                                                                                                  |
|                            |  HybridGraceHashJoin:true                                                                                                                                                                      |
|                            |  keys:{"Map 1":"_col74 (type: int)","Map 5":"wm_wk (type: int)"}                                                                                                                               |
|                            |  outputColumnNames:["_col53","_col127","_col141","_col254"]                                                                                                                                    |
|                            |  Statistics:Num rows: 125672130 Data size: 13572590298 Basic stats: COMPLETE Column stats: NONE                                                                                                |
|                            |<-Map 5 [BROADCAST_EDGE] vectorized                                                                                                                                                             |
|                            |  Reduce Output Operator [RS_2368]                                                                                                                                                              |
|                            |     key expressions:wm_wk (type: int)                                                                                                                                                          |
|                            |     Map-reduce partition columns:wm_wk (type: int)                                                                                                                                             |
|                            |     sort order:+                                                                                                                                                                               |
|                            |     Statistics:Num rows: 1040 Data size: 1483040 Basic stats: COMPLETE Column stats: NONE                                                                                                      |
|                            |     TableScan [TS_2330]                                                                                                                                                                        |
|                            |        alias:wm_m_cal_week_2                                                                                                                                                                   |
|                            |        Statistics:Num rows: 1040 Data size: 1483040 Basic stats: COMPLETE Column stats: NONE                                                                                                   |
|                            |<-Map Join Operator [MAPJOIN_2371]                                                                                                                                                              |
|                               |  condition map:[{"":"Inner Join 0 to 1"}]                                                                                                                                                   |
|                               |  HybridGraceHashJoin:true                                                                                                                                                                   |
|                               |  keys:{"Map 1":"_col1 (type: string)","Map 4":"wm_item_nbr (type: string)"}                                                                                                                 |
|                               |  outputColumnNames:["_col53","_col74","_col127","_col141","_col254"]                                                                                                                        |
|                               |  Statistics:Num rows: 114247389 Data size: 12338718186 Basic stats: COMPLETE Column stats: NONE                                                                                             |
|                               |<-Map 4 [BROADCAST_EDGE] vectorized                                                                                                                                                          |
|                               |  Reduce Output Operator [RS_2367]                                                                                                                                                           |
|                               |     key expressions:wm_item_nbr (type: string)                                                                                                                                              |
|                               |     Map-reduce partition columns:wm_item_nbr (type: string)                                                                                                                                 |
|                               |     sort order:+                                                                                                                                                                            |
|                               |     Statistics:Num rows: 9743 Data size: 113431200 Basic stats: COMPLETE Column stats: NONE                                                                                                 |
|                               |     value expressions:supplier (type: string)                                                                                                                                               |
|                               |     Filter Operator [FIL_2366]                                                                                                                                                              |
|                               |        predicate:wm_item_nbr is not null (type: boolean)                                                                                                                                    |
|                               |        Statistics:Num rows: 9743 Data size: 113431200 Basic stats: COMPLETE Column stats: NONE                                                                                              |
|                               |        TableScan [TS_2329]                                                                                                                                                                  |
|                               |           alias:item_flatten                                                                                                                                                                |
|                               |           Statistics:Num rows: 19486 Data size: 226862401 Basic stats: COMPLETE Column stats: NONE                                                                                          |
|                               |<-Map Join Operator [MAPJOIN_2370]                                                                                                                                                           |
|                                  |  condition map:[{"":"Left Outer Join0 to 1"}]                                                                                                                                            |
|                                  |  HybridGraceHashJoin:true                                                                                                                                                                |
|                                  |  keys:{"Map 3":"wm_str_nbr__store_cleaned (type: int)","Map 1":"wmstrnbr (type: int)"}                                                                                                   |
|                                  |  outputColumnNames:["_col1","_col53","_col74","_col127","_col141"]                                                                                                                       |
|                                  |  Statistics:Num rows: 103861261 Data size: 11217016290 Basic stats: COMPLETE Column stats: NONE                                                                                          |
|                                  |<-Map 3 [BROADCAST_EDGE] vectorized                                                                                                                                                       |
|                                  |  Reduce Output Operator [RS_2365]                                                                                                                                                        |
|                                  |     key expressions:wm_str_nbr__store_cleaned (type: int)                                                                                                                                |
|                                  |     Map-reduce partition columns:wm_str_nbr__store_cleaned (type: int)                                                                                                                   |
|                                  |     sort order:+                                                                                                                                                                         |
|                                  |     Statistics:Num rows: 5623 Data size: 32683918 Basic stats: COMPLETE Column stats: NONE                                                                                               |
|                                  |     value expressions:idr_dflt_whse (type: string), clx_iri_market_area (type: string)                                                                                                   |
|                                  |     TableScan [TS_2328]                                                                                                                                                                  |
|                                  |        alias:store_flattened                                                                                                                                                             |
|                                  |        Statistics:Num rows: 5623 Data size: 32683918 Basic stats: COMPLETE Column stats: NONE                                                                                            |
|                                  |<-Filter Operator [FIL_2369]                                                                                                                                                              |
|                                        predicate:(wm_item_nbr is not null and (sales_amt_last_wk > 10.0)) (type: boolean)                                                                                                   |
|                                        Statistics:Num rows: 94419327 Data size: 10197287316 Basic stats: COMPLETE Column stats: COMPLETE                                                                                    |
|                                        TableScan [TS_2327]                                                                                                                                                                  |
|                                           alias:pos_inv_fact_rollup                                                                                                                                                         |
|                                           Statistics:Num rows: 283257982 Data size: 178863439624 Basic stats: COMPLETE Column stats: COMPLETE                                                                               |
|                                                                                                                                                                                                                             |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--+
92 rows selected (4.861 seconds)