<!DOCTYPE html>
<!-- saved from url=(0103)https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/SQL/execution?id=56 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="./query01_files/bootstrap.min.css" type="text/css"><link rel="stylesheet" href="./query01_files/vis.min.css" type="text/css"><link rel="stylesheet" href="./query01_files/webui.css" type="text/css"><link rel="stylesheet" href="./query01_files/timeline-view.css" type="text/css"><script src="./query01_files/sorttable.js"></script><script src="./query01_files/jquery-1.11.1.min.js"></script><script src="./query01_files/vis.min.js"></script><script src="./query01_files/bootstrap-tooltip.js"></script><script src="./query01_files/initialize-tooltips.js"></script><script src="./query01_files/table.js"></script><script src="./query01_files/additional-metrics.js"></script><script src="./query01_files/timeline-view.js"></script><script src="./query01_files/log-view.js"></script>
        
        <title>org.apache.spark.sql.hive.thriftserver.HiveThriftServer2 - Details for Query 56</title>
      </head>
      <body><div id="StayFocusd-infobar" style="display:none;">
    <img src="chrome-extension://laankejkbhbdhmipfmgcngdelahlfoji/common/img/eye_19x19_red.png">
    <span id="StayFocusd-infobar-msg"></span>
    <span id="StayFocusd-infobar-links">
        <a id="StayFocusd-infobar-never-show">hide forever</a>&nbsp;&nbsp;|&nbsp;&nbsp;
        <a id="StayFocusd-infobar-hide">hide once</a>
    </span>
</div>
        <div class="navbar navbar-static-top">
          <div class="navbar-inner">
            <div class="brand">
              <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/" class="brand">
                <img src="./query01_files/spark-logo-77x50px-hd.png">
                <span class="version">2.0.2.2.5.5.3-2</span>
              </a>
            </div>
            <p class="navbar-text pull-right">
              <strong title="org.apache.spark.sql.hive.thriftserver.HiveThriftServer2">org.apache.spark.sql.hive.thrift...</strong> application UI
            </p>
            <ul class="nav"><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/">Jobs</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/stages/">Stages</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/storage/">Storage</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/environment/">Environment</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/executors/">Executors</a>
      </li><li class="active">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/SQL/">SQL</a>
      </li><li class="">
        <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/sqlserver/">JDBC/ODBC Server</a>
      </li></ul>
          </div>
        </div>
        <div class="container-fluid">
          <div class="row-fluid">
            <div class="span12">
              <h3 style="vertical-align: bottom; display: inline-block;">
                Details for Query 56
                
              </h3>
            </div>
          </div>
          <div>
          <ul class="unstyled">
            <li>
              <strong>Submitted Time: </strong>2017/10/28 06:17:01
            </li>
            <li>
              <strong>Duration: </strong>7 s
            </li>
            
            <li>
                <strong>Succeeded Jobs: </strong>
                <a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=151">151</a><span>&nbsp;</span><a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=152">152</a><span>&nbsp;</span><a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=153">153</a><span>&nbsp;</span><a href="https://infoworks.azurehdinsight.net/yarnui/hn/proxy/application_1509135054154_0032/jobs/job?id=154">154</a><span>&nbsp;</span>
              </li>
            
          </ul>
        </div><div>
      <div id="plan-viz-graph"><svg viewBox="-21 -16 993.9375 1504.9375" width="993.9375" height="1504.9375"><g><g class="output"><g class="clusters"><g class="cluster_0 cluster" name="WholeStageCodegen\n\n\n488 ms (0 ms, 1 ms, 25 ms)" style="opacity: 1;"><rect width="290.46875" height="209.59375" x="23.859375" y="1263.34375" rx="5" ry="5"></rect><g class="label" text-anchor="end" transform="translate(374.359375,1289.1875)"><g transform="translate(-72.953125,-12.921875)"><text><tspan space="preserve" dy="1em" x="1">WholeStageCodegen</tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1">488 ms (0 ms, 1 ms, 25 ms)</tspan></text></g></g></g><g class="cluster_3 cluster" name="WholeStageCodegen\n\n\n6.0 m (847 ms, 1.6 s, 4.9 s)" style="opacity: 1;"><rect width="327.3515625" height="1082.8125" x="-5" y="61.84375" rx="5" ry="5"></rect><g class="label" text-anchor="end" transform="translate(380.84375,87.6875)"><g transform="translate(-71.4140625,-12.921875)"><text><tspan space="preserve" dy="1em" x="1">WholeStageCodegen</tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1">6.0 m (847 ms, 1.6 s, 4.9 s)</tspan></text></g></g></g><g class="cluster_16 cluster" name="WholeStageCodegen\n\n\n11 ms (1 ms, 1 ms, 2 ms)" style="opacity: 1;"><rect width="340.953125" height="138.53125" x="419.8984375" y="220.0625" rx="5" ry="5"></rect><g class="label" text-anchor="end" transform="translate(814.296875,245.90625)"><g transform="translate(-66.3671875,-12.921875)"><text><tspan space="preserve" dy="1em" x="1">WholeStageCodegen</tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1">11 ms (1 ms, 1 ms, 2 ms)</tspan></text></g></g></g><g class="cluster_20 cluster" name="WholeStageCodegen\n\n\n1 ms (1 ms, 1 ms, 1 ms)" style="opacity: 1;"><rect width="424.18359375" height="138.53125" x="532.75390625" y="500.96875" rx="5" ry="5"></rect><g class="label" text-anchor="end" transform="translate(1007.09375,526.8125)"><g transform="translate(-63.078125,-12.921875)"><text><tspan space="preserve" dy="1em" x="1">WholeStageCodegen</tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1"></tspan><tspan space="preserve" dy="1em" x="1">1 ms (1 ms, 1 ms, 1 ms)</tspan></text></g></g></g></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M169.09375,1249.1875L169.09374999999997,1253.3541666666665C169.09375,1257.5208333333333,169.09375,1265.8541666666665,169.09374999999997,1274.1875C169.09375,1282.5208333333333,169.09375,1290.8541666666665,169.09374999999997,1299.1875C169.09375,1307.5208333333333,169.09375,1315.8541666666665,169.09374999999997,1320.0208333333333L169.09375,1324.1875" marker-end="url(#arrowhead158)" style="fill: none;"></path><defs><marker id="arrowhead158" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M169.09375,1114.65625L169.09374999999997,1118.8229166666665C169.09375,1122.9895833333333,169.09375,1131.3229166666665,169.09374999999997,1139.65625C169.09375,1147.9895833333333,169.09375,1156.3229166666665,169.09374999999997,1164.65625C169.09375,1172.9895833333333,169.09375,1181.3229166666665,169.09374999999997,1185.4895833333333L169.09375,1189.65625" marker-end="url(#arrowhead159)" style="fill: none;"></path><defs><marker id="arrowhead159" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M169.09375,945.90625L169.09374999999997,950.0729166666665C169.09375,954.2395833333333,169.09375,962.5729166666665,169.09374999999997,970.9062499999999C169.09375,979.2395833333333,169.09375,987.5729166666666,169.09374999999997,991.7395833333333L169.09375,995.90625" marker-end="url(#arrowhead160)" style="fill: none;"></path><defs><marker id="arrowhead160" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M169.09375,865.40625L169.09374999999997,869.5729166666666C169.09375,873.7395833333333,169.09375,882.0729166666666,169.09374999999997,890.40625C169.09375,898.7395833333333,169.09375,907.0729166666665,169.09374999999997,911.2395833333333L169.09375,915.40625" marker-end="url(#arrowhead161)" style="fill: none;"></path><defs><marker id="arrowhead161" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M159.09375,741.359375L159.09375,749.9192708333333C159.09375,758.4791666666666,159.09375,775.5989583333333,159.94681035402004,788.3255208333333C160.7998707080401,801.0520833333333,162.50599141608018,809.3854166666665,163.35905177010022,813.5520833333333L164.21211212412027,817.71875" marker-end="url(#arrowhead162)" style="fill: none;"></path><defs><marker id="arrowhead162" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M159.09375,609.5L159.09375,613.6666666666666C159.09375,617.8333333333333,159.09375,626.1666666666666,159.09375,634.5C159.09375,642.8333333333333,159.09375,651.1666666666666,159.09375,663.8932291666666C159.09375,676.6197916666666,159.09375,693.7395833333333,159.09375,702.2994791666666L159.09375,710.859375" marker-end="url(#arrowhead163)" style="fill: none;"></path><defs><marker id="arrowhead163" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M149.09375,460.453125L149.09375,469.0130208333333C149.09375,477.57291666666663,149.09375,494.6927083333333,149.09375,507.4192708333333C149.09375,520.1458333333333,149.09375,528.4791666666666,149.94681035402004,536.8125C150.7998707080401,545.1458333333333,152.50599141608018,553.4791666666666,153.35905177010022,557.6458333333333L154.21211212412027,561.8125" marker-end="url(#arrowhead164)" style="fill: none;"></path><defs><marker id="arrowhead164" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M149.09375,328.59375L149.09375,332.7604166666667C149.09375,336.9270833333333,149.09375,345.26041666666663,149.09375,353.59374999999994C149.09375,361.9270833333333,149.09375,370.26041666666663,149.09375,382.98697916666663C149.09375,395.71354166666663,149.09375,412.83333333333326,149.09375,421.39322916666663L149.09375,429.953125" marker-end="url(#arrowhead165)" style="fill: none;"></path><defs><marker id="arrowhead165" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M139.09375,188.140625L139.09374999999997,195.26822916666666C139.09375,202.39583333333331,139.09375,216.65104166666666,139.09374999999997,227.9453125C139.09375,239.23958333333331,139.09375,247.57291666666666,139.94681035402002,255.90625C140.7998707080401,264.2395833333333,142.50599141608018,272.57291666666663,143.3590517701002,276.7395833333333L144.21211212412027,280.90625" marker-end="url(#arrowhead166)" style="fill: none;"></path><defs><marker id="arrowhead166" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M139.09375,47.6875L139.09374999999997,51.85416666666666C139.09375,56.02083333333333,139.09375,64.35416666666666,139.09374999999997,72.6875C139.09375,81.02083333333333,139.09375,89.35416666666666,139.09374999999997,100.6484375C139.09375,111.94270833333333,139.09375,126.19791666666666,139.09374999999997,133.32552083333331L139.09375,140.453125" marker-end="url(#arrowhead167)" style="fill: none;"></path><defs><marker id="arrowhead167" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M352.3515625,187.12566520649946L329.1634114583333,194.42242933874957C305.97526041666663,201.71919347099964,259.5989583333333,216.31272173549982,236.41080729166666,227.77615253441658C213.22265625,239.23958333333331,213.22265625,247.57291666666666,207.75207350314565,255.90625C202.2814907562913,264.2395833333333,191.34032526258264,272.57291666666663,185.8697425157283,276.7395833333333L180.39915976887397,280.90625" marker-end="url(#arrowhead168)" style="fill: none;"></path><defs><marker id="arrowhead168" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M424.8984375,47.6875L424.8984375,51.85416666666666C424.8984375,56.02083333333333,424.8984375,64.35416666666666,424.8984375,72.6875C424.8984375,81.02083333333333,424.8984375,89.35416666666666,424.8984375,97.6875C424.8984375,106.02083333333333,424.8984375,114.35416666666666,424.8984375,118.52083333333331L424.8984375,122.6875" marker-end="url(#arrowhead169)" style="fill: none;"></path><defs><marker id="arrowhead169" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M556.6640625,457.76302273947925L501.0904947916667,466.771268949566C445.5169270833333,475.77951515965276,334.36979166666663,493.7960075798264,278.7962239583333,506.97092045657985C223.22265625,520.1458333333333,223.22265625,528.4791666666666,217.75207350314565,536.8125C212.2814907562913,545.1458333333333,201.34032526258264,553.4791666666666,195.86974251572832,557.6458333333333L190.39915976887397,561.8125" marker-end="url(#arrowhead170)" style="fill: none;"></path><defs><marker id="arrowhead170" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M634.1484375,328.59375L634.1484375,332.7604166666667C634.1484375,336.9270833333333,634.1484375,345.26041666666663,634.1484375,353.59374999999994C634.1484375,361.9270833333333,634.1484375,370.26041666666663,634.1484375,378.59375C634.1484375,386.9270833333333,634.1484375,395.26041666666663,634.1484375,399.4270833333333L634.1484375,403.59375" marker-end="url(#arrowhead171)" style="fill: none;"></path><defs><marker id="arrowhead171" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M634.1484375,188.140625L634.1484375,195.26822916666666C634.1484375,202.39583333333331,634.1484375,216.65104166666666,634.1484375,227.9453125C634.1484375,239.23958333333331,634.1484375,247.57291666666666,634.1484375,255.90625C634.1484375,264.2395833333333,634.1484375,272.57291666666663,634.1484375,276.7395833333333L634.1484375,280.90625" marker-end="url(#arrowhead172)" style="fill: none;"></path><defs><marker id="arrowhead172" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M774.140625,733.8289468171197L683.9876302083334,743.6439140142663C593.8346354166666,753.4588812114131,413.5286458333333,773.0888156057065,317.9050682948123,787.0704494695199C222.2814907562913,801.0520833333333,211.34032526258264,809.3854166666665,205.8697425157283,813.5520833333333L200.39915976887397,817.71875" marker-end="url(#arrowhead173)" style="fill: none;"></path><defs><marker id="arrowhead173" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M845.046875,609.5L845.0468749999998,613.6666666666666C845.0468749999999,617.8333333333333,845.0468749999999,626.1666666666666,845.0468749999998,634.5C845.0468749999999,642.8333333333333,845.0468749999999,651.1666666666666,845.0468749999998,659.5C845.0468749999999,667.8333333333333,845.0468749999999,676.1666666666666,845.0468749999998,680.3333333333334L845.046875,684.5" marker-end="url(#arrowhead174)" style="fill: none;"></path><defs><marker id="arrowhead174" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M845.046875,469.046875L845.0468749999998,476.1744791666666C845.0468749999999,483.30208333333326,845.0468749999999,497.55729166666663,845.0468749999998,508.8515625C845.0468749999999,520.1458333333333,845.0468749999999,528.4791666666666,845.0468749999998,536.8125C845.0468749999999,545.1458333333333,845.0468749999999,553.4791666666666,845.0468749999998,557.6458333333333L845.046875,561.8125" marker-end="url(#arrowhead175)" style="fill: none;"></path><defs><marker id="arrowhead175" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><text><tspan space="preserve" dy="1em" x="1"></tspan></text></g></g></g><g class="nodes"><g class="node_1 node" name="HashAggregate\n \nnumber of output rows: 473,589\npeak memory total (min, med, max): \n12.5 GB (64.2 MB, 64.2 MB, 64.2 MB)\nspill size total (min, med, max): \n0.0 B (0.0 B, 0.0 B, 0.0 B)\naggregate time total (min, med, max): \n311 ms (0 ms, 0 ms, 18 ms)" transform="translate(169.09375,1383.5625)" style="opacity: 1;"><rect rx="5" ry="5" x="-105.234375" y="-59.375" width="210.46875" height="118.75"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-100.234375,-54.375)"><text><tspan space="preserve" dy="1em" x="1">HashAggregate</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 473,589</tspan><tspan space="preserve" dy="1em" x="1">peak memory total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">12.5 GB (64.2 MB, 64.2 MB, 64.2 MB)</tspan><tspan space="preserve" dy="1em" x="1">spill size total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">0.0 B (0.0 B, 0.0 B, 0.0 B)</tspan><tspan space="preserve" dy="1em" x="1">aggregate time total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">311 ms (0 ms, 0 ms, 18 ms)</tspan></text></g></g><g></g></g><g class="node_2 node" name="Exchange\n \ndata size total (min, med, max): \n50.1 MB (50.1 MB, 50.1 MB, 50.1 MB)" transform="translate(169.09375,1219.421875)" style="opacity: 1;"><rect rx="5" ry="5" x="-105.8046875" y="-29.765625" width="211.609375" height="59.53125"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-100.8046875,-24.765625)"><text><tspan space="preserve" dy="1em" x="1">Exchange</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">data size total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">50.1 MB (50.1 MB, 50.1 MB, 50.1 MB)</tspan></text></g></g></g><g class="node_4 node" name="HashAggregate\n \nnumber of output rows: 473,589\npeak memory total (min, med, max): \n127.2 MB (256.0 KB, 256.0 KB, 80.0 MB)\nspill size total (min, med, max): \n0.0 B (0.0 B, 0.0 B, 0.0 B)\naggregate time total (min, med, max): \n5.9 m (846 ms, 1.6 s, 4.7 s)" transform="translate(169.09375,1055.28125)" style="opacity: 1;"><rect rx="5" ry="5" x="-113.2578125" y="-59.375" width="226.515625" height="118.75"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-108.2578125,-54.375)"><text><tspan space="preserve" dy="1em" x="1">HashAggregate</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 473,589</tspan><tspan space="preserve" dy="1em" x="1">peak memory total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">127.2 MB (256.0 KB, 256.0 KB, 80.0 MB)</tspan><tspan space="preserve" dy="1em" x="1">spill size total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">0.0 B (0.0 B, 0.0 B, 0.0 B)</tspan><tspan space="preserve" dy="1em" x="1">aggregate time total (min, med, max): </tspan><tspan space="preserve" dy="1em" x="1">5.9 m (846 ms, 1.6 s, 4.7 s)</tspan></text></g></g><g></g></g><g class="node_5 node" name="Project" transform="translate(169.09375,930.65625)" style="opacity: 1;"><rect rx="5" ry="5" x="-25.28125" y="-12" width="50.5625" height="24"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.28125,-7)"><text><tspan space="preserve" dy="1em" x="1">Project</tspan></text></g></g><g></g></g><g class="node_6 node" name="BroadcastHashJoin\n \nnumber of output rows: 1,303,193" transform="translate(169.09375,841.5625)" style="opacity: 1;"><rect rx="5" ry="5" x="-94.9296875" y="-23.84375" width="189.859375" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-89.9296875,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastHashJoin</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 1,303,193</tspan></text></g></g><g></g></g><g class="node_7 node" name="Project" transform="translate(159.09375,726.109375)" style="opacity: 1;"><rect rx="5" ry="5" x="-25.28125" y="-12" width="50.5625" height="24"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.28125,-7)"><text><tspan space="preserve" dy="1em" x="1">Project</tspan></text></g></g><g></g></g><g class="node_8 node" name="BroadcastHashJoin\n \nnumber of output rows: 1,303,193" transform="translate(159.09375,585.65625)" style="opacity: 1;"><rect rx="5" ry="5" x="-94.9296875" y="-23.84375" width="189.859375" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-89.9296875,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastHashJoin</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 1,303,193</tspan></text></g></g><g></g></g><g class="node_9 node" name="Project" transform="translate(149.09375,445.203125)" style="opacity: 1;"><rect rx="5" ry="5" x="-25.28125" y="-12" width="50.5625" height="24"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.28125,-7)"><text><tspan space="preserve" dy="1em" x="1">Project</tspan></text></g></g><g></g></g><g class="node_10 node" name="BroadcastHashJoin\n \nnumber of output rows: 1,382,090" transform="translate(149.09375,304.75)" style="opacity: 1;"><rect rx="5" ry="5" x="-94.9296875" y="-23.84375" width="189.859375" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-89.9296875,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastHashJoin</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 1,382,090</tspan></text></g></g><g></g></g><g class="node_11 node" name="Filter\n \nnumber of output rows: 1,382,090" transform="translate(139.09375,164.296875)" style="opacity: 1;"><rect rx="5" ry="5" x="-94.9296875" y="-23.84375" width="189.859375" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-89.9296875,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">Filter</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 1,382,090</tspan></text></g></g><g></g></g><g class="node_12 node" name="InMemoryTableScan\n \nnumber of output rows: 1,382,090" transform="translate(139.09375,23.84375)" style="opacity: 1;"><rect rx="5" ry="5" x="-94.9296875" y="-23.84375" width="189.859375" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-89.9296875,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">InMemoryTableScan</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 1,382,090</tspan></text></g></g></g><g class="node_13 node" name="BroadcastExchange\n \ndata size (bytes): 389,360\ntime to collect (ms): 407\ntime to build (ms): 1\ntime to broadcast (ms): 3" transform="translate(424.8984375,164.296875)" style="opacity: 1;"><rect rx="5" ry="5" x="-72.546875" y="-41.609375" width="145.09375" height="83.21875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-67.546875,-36.609375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastExchange</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">data size (bytes): 389,360</tspan><tspan space="preserve" dy="1em" x="1">time to collect (ms): 407</tspan><tspan space="preserve" dy="1em" x="1">time to build (ms): 1</tspan><tspan space="preserve" dy="1em" x="1">time to broadcast (ms): 3</tspan></text></g></g></g><g class="node_14 node" name="HiveTableScan\n \nnumber of output rows: 5,623" transform="translate(424.8984375,23.84375)" style="opacity: 1;"><rect rx="5" ry="5" x="-83.4140625" y="-23.84375" width="166.828125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-78.4140625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">HiveTableScan</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 5,623</tspan></text></g></g></g><g class="node_15 node" name="BroadcastExchange\n \ndata size (bytes): 1,023,032\ntime to collect (ms): 398\ntime to build (ms): 6\ntime to broadcast (ms): 8" transform="translate(634.1484375,445.203125)" style="opacity: 1;"><rect rx="5" ry="5" x="-77.484375" y="-41.609375" width="154.96875" height="83.21875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-72.484375,-36.609375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastExchange</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">data size (bytes): 1,023,032</tspan><tspan space="preserve" dy="1em" x="1">time to collect (ms): 398</tspan><tspan space="preserve" dy="1em" x="1">time to build (ms): 6</tspan><tspan space="preserve" dy="1em" x="1">time to broadcast (ms): 8</tspan></text></g></g></g><g class="node_17 node" name="Filter\n \nnumber of output rows: 19,486" transform="translate(634.1484375,304.75)" style="opacity: 1;"><rect rx="5" ry="5" x="-86.703125" y="-23.84375" width="173.40625" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-81.703125,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">Filter</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 19,486</tspan></text></g></g><g></g></g><g class="node_18 node" name="HiveTableScan\n \nnumber of output rows: 19,486" transform="translate(634.1484375,164.296875)" style="opacity: 1;"><rect rx="5" ry="5" x="-86.703125" y="-23.84375" width="173.40625" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-81.703125,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">HiveTableScan</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 19,486</tspan></text></g></g></g><g class="node_19 node" name="BroadcastExchange\n \ndata size (bytes): 16\ntime to collect (ms): 399\ntime to build (ms): 0\ntime to broadcast (ms): 5" transform="translate(845.046875,726.109375)" style="opacity: 1;"><rect rx="5" ry="5" x="-70.90625" y="-41.609375" width="141.8125" height="83.21875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-65.90625,-36.609375)"><text><tspan space="preserve" dy="1em" x="1">BroadcastExchange</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">data size (bytes): 16</tspan><tspan space="preserve" dy="1em" x="1">time to collect (ms): 399</tspan><tspan space="preserve" dy="1em" x="1">time to build (ms): 0</tspan><tspan space="preserve" dy="1em" x="1">time to broadcast (ms): 5</tspan></text></g></g></g><g class="node_21 node" name="Filter\n \nnumber of output rows: 1" transform="translate(845.046875,585.65625)" style="opacity: 1;"><rect rx="5" ry="5" x="-71.890625" y="-23.84375" width="143.78125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-66.890625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">Filter</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 1</tspan></text></g></g><g></g></g><g class="node_22 node" name="HiveTableScan\n \nnumber of output rows: 1,040" transform="translate(845.046875,445.203125)" style="opacity: 1;"><rect rx="5" ry="5" x="-83.4140625" y="-23.84375" width="166.828125" height="47.6875"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-78.4140625,-18.84375)"><text><tspan space="preserve" dy="1em" x="1">HiveTableScan</tspan><tspan space="preserve" dy="1em" x="1"> </tspan><tspan space="preserve" dy="1em" x="1">number of output rows: 1,040</tspan></text></g></g></g></g></g></g></svg></div>
      <div id="plan-viz-metadata" style="display:none">
        <div class="dot-file">
          digraph G {

  subgraph cluster0 {
    label="WholeStageCodegen\n\n\n488 ms (0 ms, 1 ms, 25 ms)";
      1 [label="HashAggregate\n \nnumber of output rows: 473,589\npeak memory total (min, med, max): \n12.5 GB (64.2 MB, 64.2 MB, 64.2 MB)\nspill size total (min, med, max): \n0.0 B (0.0 B, 0.0 B, 0.0 B)\naggregate time total (min, med, max): \n311 ms (0 ms, 0 ms, 18 ms)"];
  }
     
  2 [label="Exchange\n \ndata size total (min, med, max): \n50.1 MB (50.1 MB, 50.1 MB, 50.1 MB)"];

  subgraph cluster3 {
    label="WholeStageCodegen\n\n\n6.0 m (847 ms, 1.6 s, 4.9 s)";
      4 [label="HashAggregate\n \nnumber of output rows: 473,589\npeak memory total (min, med, max): \n127.2 MB (256.0 KB, 256.0 KB, 80.0 MB)\nspill size total (min, med, max): \n0.0 B (0.0 B, 0.0 B, 0.0 B)\naggregate time total (min, med, max): \n5.9 m (846 ms, 1.6 s, 4.7 s)"];    
  5 [label="Project"];    
  6 [label="BroadcastHashJoin\n \nnumber of output rows: 1,303,193"];    
  7 [label="Project"];    
  8 [label="BroadcastHashJoin\n \nnumber of output rows: 1,303,193"];    
  9 [label="Project"];    
  10 [label="BroadcastHashJoin\n \nnumber of output rows: 1,382,090"];    
  11 [label="Filter\n \nnumber of output rows: 1,382,090"];
  }
     
  12 [label="InMemoryTableScan\n \nnumber of output rows: 1,382,090"];
  13 [label="BroadcastExchange\n \ndata size (bytes): 389,360\ntime to collect (ms): 407\ntime to build (ms): 1\ntime to broadcast (ms): 3"];
  14 [label="HiveTableScan\n \nnumber of output rows: 5,623"];
  15 [label="BroadcastExchange\n \ndata size (bytes): 1,023,032\ntime to collect (ms): 398\ntime to build (ms): 6\ntime to broadcast (ms): 8"];

  subgraph cluster16 {
    label="WholeStageCodegen\n\n\n11 ms (1 ms, 1 ms, 2 ms)";
      17 [label="Filter\n \nnumber of output rows: 19,486"];
  }
     
  18 [label="HiveTableScan\n \nnumber of output rows: 19,486"];
  19 [label="BroadcastExchange\n \ndata size (bytes): 16\ntime to collect (ms): 399\ntime to build (ms): 0\ntime to broadcast (ms): 5"];

  subgraph cluster20 {
    label="WholeStageCodegen\n\n\n1 ms (1 ms, 1 ms, 1 ms)";
      21 [label="Filter\n \nnumber of output rows: 1"];
  }
     
  22 [label="HiveTableScan\n \nnumber of output rows: 1,040"];
  2-&gt;1;

  4-&gt;2;

  5-&gt;4;

  6-&gt;5;

  7-&gt;6;

  8-&gt;7;

  9-&gt;8;

  10-&gt;9;

  11-&gt;10;

  12-&gt;11;

  13-&gt;10;

  14-&gt;13;

  15-&gt;8;

  17-&gt;15;

  18-&gt;17;

  19-&gt;6;

  21-&gt;19;

  22-&gt;21;

}
        </div>
        <div id="plan-viz-metadata-size">23</div>
        <div id="plan-meta-data-1">HashAggregate(keys=[CLX_IRI_MARKET_AREA#47424, IDR_DFLT_WHSE#47410, SALES_AMT_LAST_WK#47340, SUPPLIER#47534], functions=[count(1)])</div><div id="plan-meta-data-0">WholeStageCodegen</div><div id="plan-meta-data-2">Exchange hashpartitioning(CLX_IRI_MARKET_AREA#47424, IDR_DFLT_WHSE#47410, SALES_AMT_LAST_WK#47340, SUPPLIER#47534, 200)</div><div id="plan-meta-data-4">HashAggregate(keys=[CLX_IRI_MARKET_AREA#47424, IDR_DFLT_WHSE#47410, SALES_AMT_LAST_WK#47340, SUPPLIER#47534], functions=[partial_count(1)])</div><div id="plan-meta-data-5">Project [sales_amt_last_wk#47340, idr_dflt_whse#47410, clx_iri_market_area#47424, supplier#47534]</div><div id="plan-meta-data-6">BroadcastHashJoin [WM_WK#47286], [WM_WK#47594], Inner, BuildRight</div><div id="plan-meta-data-7">Project [sales_amt_last_wk#47340, wm_wk#47286, idr_dflt_whse#47410, clx_iri_market_area#47424, supplier#47534]</div><div id="plan-meta-data-8">BroadcastHashJoin [WM_ITEM_NBR#47288], [WM_ITEM_NBR#47439], Inner, BuildRight</div><div id="plan-meta-data-9">Project [wm_item_nbr#47288, sales_amt_last_wk#47340, wm_wk#47286, idr_dflt_whse#47410, clx_iri_market_area#47424]</div><div id="plan-meta-data-10">BroadcastHashJoin [WMSTRNBR#47287], [WM_STR_NBR__STORE_CLEANED#47364], LeftOuter, BuildRight</div><div id="plan-meta-data-11">Filter ((isnotnull(WM_ITEM_NBR#47288) &amp;&amp; (WM_WK#47286 = 201634)) &amp;&amp; isnotnull(WM_WK#47286))</div><div id="plan-meta-data-3">WholeStageCodegen</div><div id="plan-meta-data-12">InMemoryTableScan [wmstrnbr#47287, wm_item_nbr#47288, sales_amt_last_wk#47340, wm_wk#47286], [isnotnull(WM_ITEM_NBR#47288), (WM_WK#47286 = 201634), isnotnull(WM_WK#47286)]</div><div id="plan-meta-data-13">BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))</div><div id="plan-meta-data-14">HiveTableScan [wm_str_nbr__store_cleaned#47364, idr_dflt_whse#47410, clx_iri_market_area#47424], MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED</div><div id="plan-meta-data-15">BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, false]))</div><div id="plan-meta-data-17">Filter isnotnull(WM_ITEM_NBR#47439)</div><div id="plan-meta-data-16">WholeStageCodegen</div><div id="plan-meta-data-18">HiveTableScan [wm_item_nbr#47439, supplier#47534], MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN</div><div id="plan-meta-data-19">BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)))</div><div id="plan-meta-data-21">Filter (isnotnull(WM_WK#47594) &amp;&amp; (WM_WK#47594 = 201634))</div><div id="plan-meta-data-20">WholeStageCodegen</div><div id="plan-meta-data-22">HiveTableScan [wm_wk#47594], MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2</div>
      </div>
      <link rel="stylesheet" href="./query01_files/spark-sql-viz.css" type="text/css"><script src="./query01_files/d3.min.js"></script><script src="./query01_files/dagre-d3.min.js"></script><script src="./query01_files/graphlib-dot.min.js"></script><script src="./query01_files/spark-sql-viz.js"></script>
      <script>$(function() { renderPlanViz(); })</script>
    </div><div>
      <span style="cursor: pointer;" onclick="clickPhysicalPlanDetails();">
        <span id="physical-plan-details-arrow" class="arrow-closed"></span>
        <a>Details</a>
      </span>
    </div><div id="physical-plan-details" style="display: none;">
      <pre>== Parsed Logical Plan ==
'Aggregate ['STORE_FLATTENED.CLX_IRI_MARKET_AREA, 'STORE_FLATTENED.IDR_DFLT_WHSE, 'POS_INV_FACT_ROLLUP.SALES_AMT_LAST_WK, 'ITEM_FLATTEN.SUPPLIER], [unresolvedalias('count(1), None)]
+- 'Filter ('WM_M_CAL_WEEK_2.WM_WK = 201634)
   +- 'Join LeftOuter, ('POS_INV_FACT_ROLLUP.WM_WK = 'WM_M_CAL_WEEK_2.WM_WK)
      :- 'Join Inner, ('POS_INV_FACT_ROLLUP.WM_ITEM_NBR = 'ITEM_FLATTEN.WM_ITEM_NBR)
      :  :- 'Join LeftOuter, ('POS_INV_FACT_ROLLUP.WMSTRNBR = 'STORE_FLATTENED.WM_STR_NBR__STORE_CLEANED)
      :  :  :- 'UnresolvedRelation `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`, POS_INV_FACT_ROLLUP
      :  :  +- 'UnresolvedRelation `8N_POS_INV_DASHBOARD_CUBE`.`STORE_FLATTENED`, STORE_FLATTENED
      :  +- 'UnresolvedRelation `8N_POS_INV_DASHBOARD_CUBE`.`ITEM_FLATTEN`, ITEM_FLATTEN
      +- 'UnresolvedRelation `8N_POS_INV_DASHBOARD_CUBE`.`WM_M_CAL_WEEK_2`, WM_M_CAL_WEEK_2

== Analyzed Logical Plan ==
count(1): bigint
Aggregate [CLX_IRI_MARKET_AREA#47424, IDR_DFLT_WHSE#47410, SALES_AMT_LAST_WK#47340, SUPPLIER#47534], [count(1) AS count(1)#47640L]
+- Filter (WM_WK#47594 = 201634)
   +- Join LeftOuter, (WM_WK#47286 = WM_WK#47594)
      :- Join Inner, (WM_ITEM_NBR#47288 = WM_ITEM_NBR#47439)
      :  :- Join LeftOuter, (WMSTRNBR#47287 = WM_STR_NBR__STORE_CLEANED#47364)
      :  :  :- MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup, POS_INV_FACT_ROLLUP
      :  :  +- MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
      :  +- MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
      +- MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2

== Optimized Logical Plan ==
Aggregate [CLX_IRI_MARKET_AREA#47424, IDR_DFLT_WHSE#47410, SALES_AMT_LAST_WK#47340, SUPPLIER#47534], [count(1) AS count(1)#47640L]
+- Project [sales_amt_last_wk#47340, idr_dflt_whse#47410, clx_iri_market_area#47424, supplier#47534]
   +- Join Inner, (WM_WK#47286 = WM_WK#47594)
      :- Project [sales_amt_last_wk#47340, wm_wk#47286, idr_dflt_whse#47410, clx_iri_market_area#47424, supplier#47534]
      :  +- Join Inner, (WM_ITEM_NBR#47288 = WM_ITEM_NBR#47439)
      :     :- Project [wm_item_nbr#47288, sales_amt_last_wk#47340, wm_wk#47286, idr_dflt_whse#47410, clx_iri_market_area#47424]
      :     :  +- Join LeftOuter, (WMSTRNBR#47287 = WM_STR_NBR__STORE_CLEANED#47364)
      :     :     :- Project [wmstrnbr#47287, wm_item_nbr#47288, sales_amt_last_wk#47340, wm_wk#47286]
      :     :     :  +- Filter ((isnotnull(WM_ITEM_NBR#47288) &amp;&amp; (WM_WK#47286 = 201634)) &amp;&amp; isnotnull(WM_WK#47286))
      :     :     :     +- InMemoryRelation [wmstrnbr#47287, wm_item_nbr#47288, on_hand_qty#47289, on_hand_retail_amt#47290, on_order_qty#47291, in_transit_qty#47292, in_transit_retail_amt#47293, in_whse_qty#47294, in_whse_retail_amt#47295, whse_ss_order_qty#47296, wos#47297, sales_amt#47298, sales_qty#47299, cost_amt#47300, avg_amt#47301, si_mumd_qty#47302, si_mumd_amt#47303, si_mumd_percent#47304, gross_ship_qty#47305, gross_ship_cost_amt#47306, gross_ship_avg_amt#47307, traited_str_count#47308, valid_str_count#47309, pos_str_count#47310, ... 51 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`
      :     :     :        :  +- HiveTableScan [wmstrnbr#43605, wm_item_nbr#43606, on_hand_qty#43607, on_hand_retail_amt#43608, on_order_qty#43609, in_transit_qty#43610, in_transit_retail_amt#43611, in_whse_qty#43612, in_whse_retail_amt#43613, whse_ss_order_qty#43614, wos#43615, sales_amt#43616, sales_qty#43617, cost_amt#43618, avg_amt#43619, si_mumd_qty#43620, si_mumd_amt#43621, si_mumd_percent#43622, gross_ship_qty#43623, gross_ship_cost_amt#43624, gross_ship_avg_amt#43625, traited_str_count#43626, valid_str_count#43627, pos_str_count#43628, ... 51 more fields], MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup
      :     :     +- Project [wm_str_nbr__store_cleaned#47364, idr_dflt_whse#47410, clx_iri_market_area#47424]
      :     :        +- MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
      :     +- Project [wm_item_nbr#47439, supplier#47534]
      :        +- Filter isnotnull(WM_ITEM_NBR#47439)
      :           +- MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
      +- Project [wm_wk#47594]
         +- Filter (isnotnull(WM_WK#47594) &amp;&amp; (WM_WK#47594 = 201634))
            +- MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2

== Physical Plan ==
*HashAggregate(keys=[CLX_IRI_MARKET_AREA#47424, IDR_DFLT_WHSE#47410, SALES_AMT_LAST_WK#47340, SUPPLIER#47534], functions=[count(1)], output=[count(1)#47640L])
+- Exchange hashpartitioning(CLX_IRI_MARKET_AREA#47424, IDR_DFLT_WHSE#47410, SALES_AMT_LAST_WK#47340, SUPPLIER#47534, 200)
   +- *HashAggregate(keys=[CLX_IRI_MARKET_AREA#47424, IDR_DFLT_WHSE#47410, SALES_AMT_LAST_WK#47340, SUPPLIER#47534], functions=[partial_count(1)], output=[CLX_IRI_MARKET_AREA#47424, IDR_DFLT_WHSE#47410, SALES_AMT_LAST_WK#47340, SUPPLIER#47534, count#48018L])
      +- *Project [sales_amt_last_wk#47340, idr_dflt_whse#47410, clx_iri_market_area#47424, supplier#47534]
         +- *BroadcastHashJoin [WM_WK#47286], [WM_WK#47594], Inner, BuildRight
            :- *Project [sales_amt_last_wk#47340, wm_wk#47286, idr_dflt_whse#47410, clx_iri_market_area#47424, supplier#47534]
            :  +- *BroadcastHashJoin [WM_ITEM_NBR#47288], [WM_ITEM_NBR#47439], Inner, BuildRight
            :     :- *Project [wm_item_nbr#47288, sales_amt_last_wk#47340, wm_wk#47286, idr_dflt_whse#47410, clx_iri_market_area#47424]
            :     :  +- *BroadcastHashJoin [WMSTRNBR#47287], [WM_STR_NBR__STORE_CLEANED#47364], LeftOuter, BuildRight
            :     :     :- *Filter ((isnotnull(WM_ITEM_NBR#47288) &amp;&amp; (WM_WK#47286 = 201634)) &amp;&amp; isnotnull(WM_WK#47286))
            :     :     :  +- InMemoryTableScan [wmstrnbr#47287, wm_item_nbr#47288, sales_amt_last_wk#47340, wm_wk#47286], [isnotnull(WM_ITEM_NBR#47288), (WM_WK#47286 = 201634), isnotnull(WM_WK#47286)]
            :     :     :     :  +- InMemoryRelation [wmstrnbr#47287, wm_item_nbr#47288, on_hand_qty#47289, on_hand_retail_amt#47290, on_order_qty#47291, in_transit_qty#47292, in_transit_retail_amt#47293, in_whse_qty#47294, in_whse_retail_amt#47295, whse_ss_order_qty#47296, wos#47297, sales_amt#47298, sales_qty#47299, cost_amt#47300, avg_amt#47301, si_mumd_qty#47302, si_mumd_amt#47303, si_mumd_percent#47304, gross_ship_qty#47305, gross_ship_cost_amt#47306, gross_ship_avg_amt#47307, traited_str_count#47308, valid_str_count#47309, pos_str_count#47310, ... 51 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `8N_POS_INV_DASHBOARD_CUBE`.`POS_INV_FACT_ROLLUP`
            :     :     :     :     :  +- HiveTableScan [wmstrnbr#43605, wm_item_nbr#43606, on_hand_qty#43607, on_hand_retail_amt#43608, on_order_qty#43609, in_transit_qty#43610, in_transit_retail_amt#43611, in_whse_qty#43612, in_whse_retail_amt#43613, whse_ss_order_qty#43614, wos#43615, sales_amt#43616, sales_qty#43617, cost_amt#43618, avg_amt#43619, si_mumd_qty#43620, si_mumd_amt#43621, si_mumd_percent#43622, gross_ship_qty#43623, gross_ship_cost_amt#43624, gross_ship_avg_amt#43625, traited_str_count#43626, valid_str_count#43627, pos_str_count#43628, ... 51 more fields], MetastoreRelation 8n_pos_inv_dashboard_cube, pos_inv_fact_rollup
            :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)))
            :     :        +- HiveTableScan [wm_str_nbr__store_cleaned#47364, idr_dflt_whse#47410, clx_iri_market_area#47424], MetastoreRelation 8n_pos_inv_dashboard_cube, store_flattened, STORE_FLATTENED
            :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, false]))
            :        +- *Filter isnotnull(WM_ITEM_NBR#47439)
            :           +- HiveTableScan [wm_item_nbr#47439, supplier#47534], MetastoreRelation 8n_pos_inv_dashboard_cube, item_flatten, ITEM_FLATTEN
            +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)))
               +- *Filter (isnotnull(WM_WK#47594) &amp;&amp; (WM_WK#47594 = 201634))
                  +- HiveTableScan [wm_wk#47594], MetastoreRelation 8n_pos_inv_dashboard_cube, wm_m_cal_week_2, WM_M_CAL_WEEK_2</pre>
    </div><script>
      function clickPhysicalPlanDetails() {
        $('#physical-plan-details').toggle();
        $('#physical-plan-details-arrow').toggleClass('arrow-open').toggleClass('arrow-closed');
      }
    </script><br>
        </div>
      
    </body></html>